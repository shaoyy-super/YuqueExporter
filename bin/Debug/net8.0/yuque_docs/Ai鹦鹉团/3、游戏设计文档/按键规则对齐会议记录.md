# 一、规则说明
## **1.1星级置灰规则**
+ 1-BPMInfo表参数为0的星级置灰。
+ 翻倍、减半后的速度级别为0的星级置灰。

## 1.2读表规则
一共有3个表分别为1-BPMInfo、2-StarInfo、3-RoundInfo。

**默认数据：**

1. 确定数据：在1-BPMInfo里找到歌曲对应的【速度级别】，读取那一行的【默认星级】、【默认最小键数】、【默认最大键数】
2. 在3-RoundInfo中找到步骤1确定的【默认最大键数】的对应列，按照该列的数据生成谱。

若不支持：xxxx，（x+1）（x+1）（x+1）（x+1）......yyyy，xxxx，（x+1）（x+1）（x+1）（x+1）......

若不支持则减半：xx，（x+1）（x+1）......yy，xx，（x+1）（x+1）

若不支持则从最小键值开始裁：（x+1）（x+1），（x+2）（x+2）.......yy，（x+1）（x+1）

（x+2）（x+2），（x+3）（x+3）.......yy，（x+2）（x+2）

**调整难度档位：**

1. 确定星级：把玩家调整的档位和默认档位比较，若比默认的难度高，则取最小星级；若比默认的难度低，则取最大星级。
2. 确定数据：在2-StarInfo中找到该歌曲速度级别中步骤1确定的【星级】（1星按特殊规则找，其他星级找第一个），确定【最小键数】x、【最大键数】y
3. 若歌曲节拍数支持：xxxx，（x+1）（x+1）（x+1）（x+1）......yyyy，xxxx，（x+1）（x+1）（x+1）（x+1）......

若不支持则减半：xx，（x+1）（x+1）......yy，xx，（x+1）（x+1）

若不支持则从最小键值开始裁：（x+1）（x+1），（x+2）（x+2）.......yy，（x+1）（x+1）

（x+2）（x+2），（x+3）（x+3）.......yy，（x+2）（x+2）

+ 若玩家直接调整星级进度条，则直接从第二步开始。
+ 特殊情况：若调整的星级需要翻倍或减半，则将当前歌曲bpm乘2或除以2，假设为m，在1-BPMInfo找到bpm为m对应的【歌曲速度级别】，然后在2-StarInfo中找到该歌曲速度级别中找到该星级（1星按特殊规则找，其他星级找第一个），确定【最小键数】x、【最大键数】y

**调整键数范围：**

1. 在2-StarInfo中找到该歌曲速度级别中玩家调整的【最小键数】x、【最大键数】y，确定对应星级。
2. 按照xxxx，（x+1）（x+1）（x+1）（x+1）......yyyy，xxxx，（x+1）（x+1）（x+1）出键。
+ 特殊情况：提前判断歌曲支持键数范围最多多少个数，限制玩家的调整，当玩家试图拖动到大于范围的数值时，启动数值跟随。例如：最大范围是5，玩家把1-5的上限调整为6，最小值会自动变为2。

**找一星特殊规则：**

先找最小键数为1的最后一个，没有的话找最小键数为2的最后一个，以此类推。

# 二、问题对齐
## 2.1键数范围显示异常处理
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1722327624761-aa432f0f-66c1-4346-a849-70260fb0ece6.png)

讨论结果：增加提示。

## 2.1时长不够问题
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1722332275169-70e98d77-84a6-4658-aed8-631358e4e77c.png)

讨论结果：按照8-10来找。

