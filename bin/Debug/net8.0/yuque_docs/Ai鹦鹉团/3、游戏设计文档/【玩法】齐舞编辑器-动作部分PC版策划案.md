# 一、概述
### 1.1 文档说明
该文档详述了齐舞编辑器的动作、阵型部分策划案，用于制作人养成，给予玩家舞蹈编辑的ugc体验。

### 1.2 文档维护
| <font style="color:white;">版本</font> | <font style="color:white;">时间</font> | | <font style="color:white;">负责人</font> | <font style="color:white;">修改内容</font> |
| :---: | :---: | --- | :---: | :--- |
| <font style="color:black;">v1.0</font> | <font style="color:black;">2024/11/25</font> | | 王亚婷 | <font style="color:black;">文档创建</font> |


### 1.3 设计思路
本编辑器素材库、轨道区、属性设置区、预览区四个部分，玩家在素材区选取站位、动作、镜头等素材添加到轨道区的对应轨道上，可以在属性设置区对素材进行进一步编辑，在预览区观看编辑效果。

### 1.4 系统框架图
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733136775631-667d330b-0126-45d7-b57e-7b2b5c924b3d.png)

# 二、功能说明
### 2.1 素材库
素材库包含各类素材，用户将素材添加到对应种类的时间轴轨道，从而达到编辑目的。

站位素材：站位素材包含角色在舞台上的坐标、朝向信息，除了使用官方给的系统站位，玩家还可以自己编辑站位信息，并存在自定义站位中方便之后中直接使用。

动作素材：动作素材为一段固定小节（节拍）的舞蹈动作。

场景素材：场景素材为场景美术素材，场景会自带特效，玩家可设置是否显示场景中的特效。

### 2.2 轨道区
有两种方式可以添加各类素材到轨道区，一种是将素材直接拖拽至轨道区，一种是点击添加按钮，将素材添加至时间指针后。

站位轨道：用户添加站位素材默认占据4小节，玩家可再次调整缩放，但是必须卡在节拍线上，调节最小值为1拍，最大可以调到开始或结尾。若空位不足4小节，则素材长度可根据空位长短自动适应。

动作轨道：动作素材占据几小节是固定的，玩家不可调节缩放，只能拖动调整位置，但必须卡在小节线上。若空位不足，则提示玩家“没有找到合适的空间，素材添加失败”，并取消自此放置。若时间指针不在小节线上时，点击添加按钮可将素材放置在时间线下一个小节线后。

场景轨道：场景与站位相同，默认占据4小节，玩家可再次调整缩放，但是必须卡在节拍线上，调节最小值为1拍，最大可以调到开始或结尾。若空位不足4小节，则素材长度可根据空位长短自动适应。



**轨道编辑功能：**

+ 收起/展开：点击可收起/展开单个轨道。
+ 锁定/解锁：点击可锁定/解锁轨道，锁定后不可编辑轨道上的素材，右边也无反应。
+ 隐藏/显示：点击可隐藏/恢复单个轨道效果。
+ 清除所有素材：清空该条轨道所有素材。
+ 智能填充剩余部分：根据填充规则（需后续出各种素材填充规则）程序自动将该条轨道填充满。

|  | 动作轨道 | 站位轨道 | 镜头轨道 | 场景轨道 |
| :---: | :---: | :---: | :---: | :---: |
| 收起/展开 | √ | √ | √ | √ |
| 锁定/解锁 | √ | √ | √ | √ |
| 隐藏/显示 |  |  | √ | √ |
| 清除所有素材 | √ | √ | √ | √ |
| 智能填充剩余部分 | √ | √ | √ | √ |
| 重置ai舞步 | √ |  |  |  |


**轨道素材编辑功能：**

+ 删除：从轨道上删除该素材。
+ 移动：移动素材在轨道上的问题，空间足够的话可以通过移动替换两个素材的位置。
+ 缩放：缩短或者拉长素材占据的节拍数，动作素材不可缩放。
+ 复制/剪切：可将某素材复制或这剪切到其他位置，若空间不够提示“没有找到合适的空间，素材添加失败”即可。
+ 填充空白：拉伸该素材，使其填满该素材两边空位。
+ 重置ai舞步：重新把ai生成的舞步填充在轨道中，如果玩家有过改动和新增动作素材，直接覆盖即可。

|  | 动作轨道 | 站位轨道 | 镜头轨道 | 场景轨道 |
| :---: | :---: | :---: | :---: | :---: |
| 删除 | √ | √ | √ | √ |
| 移动 | √ | √ | √ | √ |
| 缩放 |  | √ | √ | √ |
| 复制/剪切 | √ | √ | √ | √ |
| 填充空白 | √ | √ | √ | √ |
| 重置ai舞步 | √ |  |  |  |


### 2.3 预览区
+ 素材库中的素材可以直接在预览区观看预览效果，预览过程中可随时退出预览。
    - 站位素材预览：角色站位为玩家预览的站位素材信息，动作、镜头等则播放轨道中当前时间指针后四小节的素材，轨道中没有添加素材则播放默认的即可。
    - 动作素材预览：播放动作为玩家预览的动作素材，站位、镜头等则播放轨道中当前时间指针后n小节的素材，轨道中没有添加素材则播放默认的即可。
    - 场景素材预览**：**场景预览方式与站位一致，同样预览4小节。
+ 轨道区的编辑成果可在预览区看效果，可通过前进、后退、暂停/播放、全屏等功能辅助预览。
+ 编辑站位素材的坐标和旋转可在预览区通过handle直接调整，辅助调整摄像机功能可协助用户更好的调整，调整摄像机功能包括：拉远、拉近、上移、下降、旋转角度。

### 2.3 属性设置区
+ 更换素材：直接替换该素材为其他素材，位置和缩放不变。
+ 调整素材起始和结束时间：可手动输入素材起始和结束的小节数以及小段数，动作素材只可设置起始小节数。
+ 站位信息：调整站位某个位置的隐藏/显示、X/Y坐标值、旋转角度值，选择某个位置的对应角色。

| 属性 | 最小值 | 最大值 | 小数点 |
| :---: | :---: | :---: | :---: |
| X | 暂时未定 | 暂时未定 | 一位 |
| Y | 暂时未定 | 暂时未定 | 一位 |
| 旋转角度 | -180 | 180 | 一位 |


# 三、界面说明
## 3.1编辑器主界面
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733742047107-d99f9a72-e3cf-4a05-bb0b-8b3bb00e0989.png)

+ 返回按钮：当玩家进入高级编辑至单击返回按钮时间段<font style="color:#DF2A3F;">有任意修改时</font>，弹出<u>通用提示弹窗</u>：您有修改未保存，是否保存？玩家单击是，则保存玩家当前的修改，返回至作品页面；玩家单击否，则不保存玩家的修改，返回至作品页面。当玩家进入高级编辑至单击返回按钮时间段<font style="color:#DF2A3F;">没有任何修改时</font>，单击返回按钮后直接返回作品页面。
+ 功能说明按钮：点击打开功能说明弹窗。（暂不开发）
+ 暂存按钮：点击暂存当前作品。
+ 设置按钮：点击打开设置弹窗。（暂不开发）
+ 完成按钮：单击保存玩家当前的修改，返回至作品页面。

### 3.1.1素材区
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733308169420-d57ccf79-0df5-4a42-8b62-24c5c230e9ce.png)

1. **页签**

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732610012981-d92114cf-6b14-4e36-9fa6-b5697b2ca781.png)

场景、特效、光照的子页签暂时未定；镜头子页签见[镜头部分策划案](https://snh48group.yuque.com/qim4en/xs9kb3/eb8oya6xi4tbadvg)。



2. **素材列表**
+ 每个素材显示内容包括图标和素材名，素材名最长6字。
+ 动作素材还需额外显示小节数。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732771340951-a64cb567-ddc6-4435-a378-89ee0ae095a0.png)

+ 用户将鼠标移到素材上时，出现预览按钮和添加按钮：

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732779269287-88af0d5b-3fae-4f25-88f0-34cddd30ea65.png)

    - 点击预览按钮![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732779968724-7cd03d61-d1d5-42ae-bca9-926446b070c0.png)可在预览区显示添加当前素材后的预览效果，此时预览按钮变为播放中图标![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733128320954-cc6adf33-1f21-4424-85e5-ebc21abdae04.png)，再次点击可结束预览。此时预览区的播放按钮变为退出预览按钮，点击结束预览，回到正常界面。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732865410133-bdad39f8-c797-47d0-ad7c-da2c24c086a3.png)

    - 点击添加按钮![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732860061885-389f772d-8312-471e-8dac-73871af7d8b3.png)可将该素材添加到对应轨道的时间指针后。



### 3.1.2轨道编辑区
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732869243750-4b1f341b-2395-4500-ad0f-675d8d240812.png)

+ 包含站位、镜头、动作、场景四个轨道（后期会新增特效和光照轨道）。
+ 轨道编辑：
    - 鼠标移到![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732868738431-11e3404f-34e8-4648-8ed4-bc9ce2773c2c.png)显示“展开/收起轨道”文本提示，点击可收起/展开单个轨道；按钮需要展开收起两种状态。
    - 鼠标移到![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732868738431-11e3404f-34e8-4648-8ed4-bc9ce2773c2c.png)显示“锁定/解锁轨道”文本提示，点击可锁定/解锁轨道，锁定后不可编辑轨道上的素材，右边也无反应；按钮需要两种状态。
    - 鼠标移到![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732869114320-75cf791c-caa1-4c2d-b54e-04ce5ba07f01.png)显示“隐藏/恢复轨道效果”文本提示，点击可隐藏/恢复单个轨道效果；按钮需要两种状态。
    - 右键空白轨道，弹出两个按钮![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732869549944-619f2506-ec31-4d91-8218-f69425a5c847.png)，点击【清除所有素材】弹出二级弹窗“确认清除该轨道所有素材吗？”，玩家确认后清楚该条轨道所有素材；点击【智能填充剩余部分】，则根据填充规则（需后续出各种素材填充规则）程序自动将该条轨道填充满。
+ 轨道素材编辑：
    - 素材组件包含内容素材名、素材图标、当前占据小节数、当前占据时间，站位素材额外展示站位包含角色。素材组件也需要选中状态和普通状态两种状态。

![展开](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732867613248-bb30322f-c05a-4687-8f2a-e71701c34400.png)

![收起](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732875074254-b062d498-456c-4d7f-8822-d39c33d65890.png)

    - 单击拖动可移动素材，可将交换素材位置（以起始点为基准）；选中素材后鼠标移到素材边缘鼠标指针变为缩放图标![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732875182428-a9dc0c7b-c0a3-4338-9b67-54321c57fd00.png)，此时滑动可缩放素材，若无空位则拉不动即可。每种素材缩放规则不完全相同，具体见2.2轨道区功能说明。
    - 右键轨道区中的素材组件弹出界面![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732875472749-b0ed9e45-3d22-40ec-b499-5a7604cfb2c4.png)，点击【填充空白】则把该素材两边空位用该素材填满；点击【复制】或【剪切】，在空白处右键【粘贴】即可将该素材粘贴到鼠标右键处后面；点击【删除】即删除该素材。右键动作素材没有【填充空白】按钮，会多一个【~~重置ai舞步】~~按钮![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1732876966693-73ecddc1-192f-4964-b713-90709d8beeeb.png)，玩家点击后会重新把ai生成的舞步填充在轨道中，如果玩家有过改动和新增动作素材，直接覆盖即可。<font style="background-color:#FBDE28;"></font>

### 3.1.3属性设置区
#### 全局设置
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733126963015-2dc818be-7c1e-491b-8d1c-f05f6cdd30d5.png)

+ 玩家什么素材都没点击的情况下只显示全局设置。
+ 角色名：显示默认的五个角色名，玩家点击后选择角色，预览区被选中的玩家需要有选中框。

![选中框参考](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733125560718-52cbf5ed-dfe6-4bc6-bdfd-bcb3a988a68c.png)

+ 更换角色按钮：点击打开更换角色弹窗（弹窗位置需不挡住预览区），在弹窗右侧角色列表点击选中某个角色后，可在预览区观看该角色位替换为此角色的效果，此时点击右下角确定按钮即可更换此角色。

![此界面ui需与外部选角色一致](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733128697111-64c38c1f-3d0d-4728-b132-84f9c9d10dfb.png)

+ 隐藏角色头顶序号标记：点击勾选此则预览区角色头顶序号隐藏，再次点击取消勾选重新显示序号。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733126806826-d4fbc709-5644-4b8e-be27-e9dd5b556a47.png)

#### 站位设置
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733126929665-4716390d-db49-4f6a-b864-5f3914a7655a.png)

+ 点击轨道区中的站位素材，此区域增加站位设置页签。
+ 修改站位按钮：点击打开更换站位弹窗：可预览站位素材，预览操作和3.1.1素材区相同；在弹窗右侧站位列表点击选中某个站位后，点击右下角确定按钮即可更换此站位。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733128110273-19436fee-58a4-41f4-aa67-cd96d4068e62.png)

+ 站位时间设置：显示当前此站位素材的开始和结束时间，玩家可通过手动输入或点击![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733129434684-23008a9d-37cd-48ae-be66-03e0aa43615e.png)![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733129440001-4ead4da0-813a-4b69-84ba-578e107f37d8.png)的方式来调整时间，点击加减号单词调整数值单位为1。
+ 站位信息设置
    - 隐藏按钮：点击隐藏该位置的角色，图标需要隐藏状态和显示状态。
    - 位置：点击可选中当前位置的角色，需要选中状态和未选中状态，在预览区和中显示角色的移动handle。

![移动handle](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733129639454-722d480e-049d-4268-8aca-c42c477589fe.png)![角色选中状态参考](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733125560718-52cbf5ed-dfe6-4bc6-bdfd-bcb3a988a68c.png?x-oss-process=image%2Fformat%2Cwebp)

    - X/Y/旋转角度：角色的坐标数值和旋转数值，点击可输入。
    - 重置坐标和角度：点击重置坐标和角度为站位默认数值。
    - 选择偶像：点击展开下拉，下拉内容为角色1-角色5供玩家选择。
    - 另存方案：点击弹出输入站位名称弹窗，名字最长六字，输入完成点击确定后则将该自定义站位素材保存到素材区的自定义页签中，预览图标给一张通用的即可。  
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733130535612-55974b36-c46b-4fa0-b458-359b9bbe702a.png)

#### 动作设置
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733130734583-9a10a9bf-0414-433a-af1e-3ea022fd8ea4.png)

动作设置内容与上述内容重合，不详细描述。

#### 场景设置
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733733945645-abaf0315-35a7-4b5b-a03f-fb82e85abe0e.png)

显示场景自带特效，默认开，玩家可关闭。

### 3.1.4预览区
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733308224332-02f8c5c9-a225-4416-af08-43348ed35602.png)

+ 当前播放时间进度。
+ 播放/前进/后退按钮：与之前一致，不赘述。
+ 移动图标：只有在选中轨道区站位素材时有移动图标，选中时拖动handle可移动角色。
+ 旋转图标：只有在选中轨道区站位素材时有旋转图标，选中时拖动handle可旋转角色。
+ 开关谱面按钮：点击切换谱面显示与否。
+ 全屏按钮：点击全屏预览区，具体与传统谱面编辑器一致。
+ 视角控制器：拖动可控制摄像机视角方向，点击可切换xyz方向视角。除了视角控制器，整个不被ui遮挡的场景区域都可以调控视角方向、远近、移动。pc端操作方式参考unity即可。

## 3.2单轨生成弹窗
#### 站位单轨生成
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733132259731-2e9fc8e9-1dbc-4adb-9332-5ed94ef917bb.png)

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733132439384-100751f2-5cf7-4b52-a54b-9d06ab491efb.png)

+ 点击添加标签可选择站位种类，标签有1人站位-5人站位五个选项；可多选，多选下方会出现比例调节，比例默认为均分，玩家可滑动![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733132819483-639e5201-85fe-40bd-984a-304e9413d3c7.png)按钮调节比例，比例数值为整数类型。
+ 点击【填充至站位轨道】即可填充轨道并关闭弹窗。

#### 动作单轨生成
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733132515170-001e3867-e59b-4378-8864-9b682dd36068.png)

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1733132718585-a151c1f1-9bea-43a5-bf11-117a01d86e76.png)

+ 需分别添加开场动作、舞步动作、结束动作三个部分的标签，开场动作和结束动作只能单选，舞步动作可多选，多选后可同样调整比例。
+ 点击【填充至动作轨道】即可填充轨道并关闭弹窗。

# 五、配置表说明
# 六、功能需求清单
# 七、美术需求清单




