# 一、概述
### 1.1 文档说明
该文档为多人舞蹈编辑器策划案，用于制作人养成，给予玩家编排多人舞蹈的体验。

### 1.2 文档维护
| <font style="color:white;">版本</font> | <font style="color:white;">时间</font> | | <font style="color:white;">负责人</font> | <font style="color:white;">修改内容</font> |
| :---: | :---: | --- | :---: | :--- |
| <font style="color:black;">v1.0</font> | <font style="color:black;">2024/9/23</font> | | 王亚婷 | <font style="color:black;">文档创建</font> |


### 1.3 设计思路
本编辑器建立在导入的音乐有对应的AI生成舞步序列的基础之上，玩家导入歌曲，并在舞步序列基础上编辑多人舞蹈的阵型变化、灯光、镜头等等，初版只可编辑阵型变化，并选择预设开场和结尾。

### 1.4 系统框架图
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728384662504-8b7340a8-6db8-464c-a0f1-d7b46621c4a7.png)

# 二、功能说明
### 2.1 导入文件
玩家可选择导入音乐或导入舞步：

+ 若选择导入音乐则支持玩家导入本地mp3或者ogg音频文件，导入成功后玩家点击开始编辑则调用音生舞AI接口，生成对应舞步，并接入本编辑器。
+ 若选择导入舞步则支持玩家导入本地舞步文件，该舞步文件为从本编辑器保存的包含舞步、阵型、开场、角色等信息的文件。导入后玩家点击开始编辑则可以在编辑器中对该文件进行查看和二次编辑。

### 2.2编辑阵型
#### 2.2.1组件栏
+ 组件栏包含阵型、开场、结尾、动作四个页签。
+ 阵型页签内为官方制作的阵型组件，每个阵型组件包含五个角色（玩家可替换）在舞台上的站位信息。
+ 开场页签内为官方制作的开场组件，每个组件包含整段表演，包括五个角色（玩家可替换）的站位、动作、灯光、镜头信息、节拍数等等。结尾组件也相同。
+ 动作页签位官方制作的舞步组件，只包含舞步信息。

#### 2.2.2编辑区域
+ 编辑区域把整首音乐按照节拍划分为最小单位为一拍，四拍一小节的区域，在每小节线上会有时刻和小节数标识。
+ 编辑区域中间有当前播放指针，玩家可拖动整个时间轴来调整当前播放帧，处于播放指针上的帧即为当前播放帧。
+ 编辑区域有默认的一个开场组件槽位、五个阵型组件槽位，槽位之间用走位组件连接，玩家可将组件从组件栏拖到槽位中，可调控槽位的长短。
+ 若玩家将组件移动到已有组件上可以替换组件，只有对应同类型组件之间可以互相替换。

#### 2.2.3基础功能
+ 播放/暂停：可以控制舞步的播放和暂停。
+ 撤销/还原：可以撤销或者还原玩家的上n步编辑操作，注意此功能只针对编辑区域的操作。
+ 保存：点击调出玩家本地，在玩家选择保存路径后存在玩家本地。（临时方案）
+ 全屏/退出全屏：点击全屏按钮后整个界面只保留设置、调整视角控制器、播放/暂停、前进5s/后退5s、从头播放按钮、退出全屏，以及保留音乐和偶像预览。
+ 前进5s/后退5s：点击可将时间轴前进、倒退5s。
+ 从头播放：点击可将时间轴直接调到0。
+ 视角控制：可以控制摄像机的视角和远近。

# 三、界面说明
## 3.1选择导入类型
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728460965959-a24bb30e-1adf-4f12-a4b7-e9626615fa41.png)

+ 点击新建作品按钮跳转3.2导入音乐界面
+ 点击导入作品按钮进入3.3导入作品界面。

## **3.2导入音乐**
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728461091391-841427be-7e5f-4a94-8c14-0e5ee6b9bc01.png)

**①****返回按钮：**点击返回3.1选择导入类型界面，若点击该按钮时此界面已上传音频文件，则保存该文件直到玩家进入编辑界面。

**②****上传音频控件**：点击调出玩家设备本地的mp3或者ogg文件供玩家选择，玩家选择完成后回到该界面，同时此控件显示该音频文件的歌曲名和歌手名，表示为“歌曲名-歌手名”（若目前功能无法支持，直接读取本地音频名称显示即可）；若玩家再次点击可再次上传，上传的音频覆盖原音频即可。

**②****开始编辑按钮**：点击调用音生舞AI接口生成对应舞步，并接入本编辑器。导入音乐弹窗消失，展示3.4编辑器主界面。

## **3.3导入作品**
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728461024202-e13e9fcb-3bdb-4d04-8ed4-a936ea91bf50.png)

**①****返回按钮：**点击返回3.1选择导入类型界面，若点击该按钮时此界面已上传舞步文件，则保存该文件直到玩家进入编辑界面。

**②****上传舞步控件**：点击调出玩家设备本地的舞步文件供玩家选择，该舞步文件为从本编辑器保存的包含舞步、阵型、开场、角色等信息的文件，玩家选择完成后回到该界面，同时此控件显示该文件的本地名称）；若玩家再次点击可再次上传，上传的舞步文件覆盖原文件即可。

**③开始编辑按钮**：点击将舞步文件接入本编辑器。导入舞步弹窗消失，展示3.4编辑器主界面。

## **3.4编辑器主界面**
![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1729058622362-f456dd3a-b4f0-43fe-877c-905e7c09a878.png)

**①****组件****栏页签：**包括阵型、开场、结尾、动作三个页签，点击切换不同类型组件显示。

**②组件：**

+ 组件包含阵型、开场、结尾、动作四种，四种组件拖出后需用颜色区分。
+ 每个组件图标都包含两个信息显示：组件图标、组件名称。
+ 阵型组件
    - 单击无效，按住滑动可拖出如下图组件，拖住时组件显示为默认长度即可，待玩家在阵型槽位内松手则自动填充进槽位，若玩家在槽位外松手则组件飞回组件栏原位。
    - 若松手位置已有阵型组件，则将原组件替换为该组件。（注意，组件只可替换同类型组件）

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728465429401-4a12f588-1977-4ead-9677-1a7eba8e60f3.png)

+ 开场、结尾组件
    - 单击开场、结尾组件，组件栏左侧固定位置显示预览弹窗，循环播放此组件预览视频，点击空白处可关闭预览界面；点击其他开场、结尾组件则预览弹窗替换为播放其他组件预览视频。（此功能初版可不开发）

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1727426246490-e8970f0f-19cc-4f23-a303-7556a98cde71.png)

    - 按住滑动可拖出组件，开场、结尾组件须放置在固定槽位内，且不可调节缩放。
+ 动作组件
    - 动作组件同样需要点击预览功能。
    - 按住滑动可拖出动作组件，动作组件须放置在动作槽位内。

**③收起/展开按钮：**

+ 点击收起按钮收起整个组件栏，只在屏幕边缘显示展开按钮，同时⑪视角控制器跟随收回。
+ 点击展开按钮恢复至默认状态。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1727599328924-c0f7d7c8-5aa1-4160-b0c1-0e4b398b9314.png)

**④搜索控件**

+ 点击调出玩家输入进行搜索，控件变为如下输入态，组件栏显示实时搜索结果。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1720074727234-6739401c-1762-4b76-9eea-37616bd35cd8.png)

+ 点击右侧关闭按钮，控件恢复默认状态，组件栏恢复默认显示。

**⑤操作区域**

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1729071693397-e6ff7eef-ec85-40bb-a44d-81b7c7dae7c3.png)

+ 包含内容：节拍线、小节线、小节时刻、小节数、音乐火焰波纹、当前播放指针及时刻，还有默认的槽位分段。20.21新增：初始舞蹈动作角色处于原点时刻需在时间轴上用红点标识。
+ 槽位包括一个开场、一个结尾和九个阵型，相邻阵型之间需通过走位部分连接。开场和结尾根据美术素材判断占据节拍，其余段位均分即可。
+ 开场、结尾槽位需拖入对应的开场、结尾组件，且长短不可调节。
+ 阵型槽位共有四种类型，分别为齐舞、c位特殊表演、vocal位特殊表演、dancer位特殊表演，齐舞只可拖入阵型，其他类型可拖入阵型和特殊动作。玩家可自行切换类型，切换后可拖动组件也需对应变化，若玩家已有拖入组件再切换类型，只存保留阵型组件即可。
+ 拖入组件后效果示意图如下：

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1729071716402-4bffeba2-404e-4777-9b97-ade3fc302d5a.png)

+ 左右滑动操作可滑动时间轴，包括时间轴上的节拍线、组件、波纹信息。
+ 拖动槽位上的组件至操作区域外可删除该组件。
+ 点击阵型槽位使其进入选中状态，可通过拖动左右两边来调控槽位的长短，操作时两边自动吸附在节拍线上。最短为1拍，最长暂不作限制。开场、结尾不可调整缩放。

![选中状态](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728465724911-a51d3774-4f89-4324-9c85-0b8094d5c4ed.png)

**⑥播放设置**

+ 播放/暂停：点击播放即从当前播放指针位置开始播放，音乐和场景中角色动作同步播放，同时时间轴跟着一起向左滑动。点击暂停音乐和角色动作同步暂停播放。
+ 前进5s/后退5s：点击时间轴即可跳转到5s前或5s后，同时音乐和角色动作倒退/前进5s。
+ 从头播放：点击时间轴回到0秒或开场组件开头，是否开始播放根据当前播放/暂停按钮的状态

**⑦全屏/退出全屏按钮**

+ 点击全屏按钮后整个界面只保留设置、调整视角控制器、播放/暂停、前进5s/后退5s、从头播放按钮、退出全屏，以及保留音乐和偶像预览。 
+ 点击退出全屏按钮，恢复点击全屏之前的界面显示。

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728372652021-5ed0f844-deb2-46e9-855f-29eac02c6752.png)

**⑧设置按钮**

+ 点击弹出设置弹窗

![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728375662662-8636b86b-1235-40c1-abb2-dd9ea4c1f28d.png)

    - 网格缩放：设置节拍线的间距，点击显示下拉列表，有0.4、0.6、0.8、1、1.2、1.4、1.6、1.8、2等选项，默认为1。
    - 播放速度：设置歌曲和舞蹈播放速度，点击显示下拉列表，有0.5、0.6、0.7、0.8、0.9、1.0、1.5，默认为1。
    - 显示火焰波纹，开为显示，点击切换为关则不显示。

**⑨保存按钮**

+ 点击调出玩家本地，在玩家选择保存路径后存在玩家本地。（临时方案）

**⑩撤销/还原按钮**

+ 可以撤销或者还原玩家的上n步编辑操作，注意此功能只针对编辑区域的操作。

**⑪视角控制器**

+ 拖动可控制摄像机视角方向，点击可切换xyz方向视角。
+ 除了视角控制器，整个不被ui遮挡的场景区域都可以调控视角方向和远近。手机端双指缩放控制远近，单指拖动指控方向；pc端操作方式参考unity即可。
+ 开场组件包含镜头信息，播开场时视角不可控制。

**⑫歌曲信息**

+ 显示识别的玩家导入歌曲名和歌手名。

**⑬偶像预览**

+ 显示当前使用偶像预览，点击可替换，功能初版暂不开发。

## **3.5选择舞者&外观**
### 3.5.1舞者格
舞者格：舞者格是更换舞蹈者的入口

![](https://cdn.nlark.com/yuque/0/2024/png/48674012/1731923176254-b2bc8a90-f6dc-4b7a-ba76-391f47bfa52a.png)

舞者格规则：

1，编辑好的舞步类型决定舞者选择列表的状态：

     *mv舞步：

       禁用格位置固定（见下文表格）

      所有启用格必须上阵舞者

| 人数 | 启用格子（其他格展示为禁用） |
| --- | --- |
| 1 | 2，3号位 |
| 2 | 2，3，4号位 |
| 3 | 1，2，3，4号位 |
| 4 | 1，2，3，4，5号位 |


     *齐舞舞步：

      所有格子启用

      舞者人数不固定（上阵1~5人均可），center位必须上阵单位

 3，center格始终为3号位（center位是逻辑上的center，主要指某些与center展示有关的段落，比如center独舞之类，不是指位置上的绝对正中间）

### 3.5.2更换舞者&外观交互
1，选择任意未禁用的舞者格，进入偶像选择界面

2，在偶像选择界面点击【更换服饰】，进入该偶像的服装更换界面。

3，mv舞步状态下， 

           *根据舞步人数，禁用上文规范中的舞步格，并默认将偶像列表排序最前的偶像置入舞者格

           进入舞者更换界面后，

           *列表项默认选中当前正处于该格的偶像，右侧预览该偶像

           *当前选择偶像，未登台，则右下角按钮显示”登台“

           *当前选择偶像，已登台，则右下角按钮显示”交换位置“

           *没有”休息“按钮

4，齐舞舞步状态下，

           *默认将偶像列表排序最前的5名偶像置入舞者格

           进入舞者更换界面。

           *列表项默认选中当前正处于该格的偶像，右侧预览该偶像

          *当前选择偶像，未登台，则右下角按钮显示”登台“

           *当前选择偶像，已登台，则右下角按钮显示”交换位置“

           *除center格外，其他格进入后存在”休息“按钮，点击”休息“则撤下该格子内的舞者，空置该格子，同时回到编辑器主界面。



<font style="color:#74B602;">【更换舞者/偶像】</font>

![](https://cdn.nlark.com/yuque/0/2024/png/48674012/1731924194278-a42d0797-ff7d-4188-bd39-9b9ff83715d2.png)

<font style="color:#74B602;">【更换舞者的外观】</font>

![](https://cdn.nlark.com/yuque/0/2024/png/48674012/1731923743989-1aa99592-33d9-40e2-9c3b-0d30c3dc9afb.png)

# 四、组件需求
## 4.1阵型组件
以下每个阵型组件需要美术调好站位信息，并给出组件图标资源![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728466541797-61dadead-499b-46dd-9e68-1d128d7c9e40.png)。

| **<font style="color:white;">组件名称</font>** | **<font style="color:white;">俯视图</font>** | **<font style="color:white;">效果参考</font>** | |
| :---: | :---: | :---: | --- |
| <font style="color:black;">正V</font> | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726724107346-e2af75a6-65ae-4d43-9c9b-3cb461c630c1.png) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726723128862-01c0b049-476d-402b-8d82-f4a4da52beb3.png) | |
| <font style="color:black;">M型</font> | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726725410926-8407c47c-d13f-4b94-82e8-242a30929a97.png) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726726014031-42670079-cc5d-4a39-a3b7-b3dc74a03fd7.png) | |
| <font style="color:black;">横一</font> | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726746585709-7c955606-1dc2-43a0-8532-9aa5229e6343.png) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726746525294-b49960e8-a2e0-4266-90ff-85705b0cbce0.png) | |
| <font style="color:black;">竖一</font> | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728383872987-ade6fc6c-1e11-4f5e-ba63-e27f86848847.png) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1726810965398-af7eee49-e7ba-4a56-b704-7358552019e2.png) | |


## 4.2开场组件
+ 每个开场需为统一节拍数，如32拍，具体数值美术提供。
+ 以下每个开场组件需要美术给出动作镜头灯光资源，同时给出组件图标资源。

| **<font style="color:white;">组件名称</font>** | **<font style="color:white;">猎星少女视频参考</font>** | **<font style="color:white;">动作截图</font>** | **<font style="color:white;">灯光镜头参考</font>** | |
| :---: | :---: | :---: | :---: | --- |
| <font style="color:black;">开场1</font> | [爱的幸运曲奇](https://www.bilibili.com/video/BV1Wx4y1s7Cv/?spm_id_from=333.337.search-card.all.click&vd_source=3d748890e07b647ea8793f10dabf8c4c) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728463116360-cd6403e1-16cd-4bd5-90b4-30c112d6e462.png) | [星瞳-瞳、Asoul-绽放](https://www.bilibili.com/video/BV1qe411F7Ac?p=2&vd_source=3d748890e07b647ea8793f10dabf8c4c)、[EOE](https://www.bilibili.com/video/BV1ij41137bm/?spm_id_from=333.337.search-card.all.click&vd_source=3d748890e07b647ea8793f10dabf8c4c)<br/>[酷帅参考-星瞳](https://www.bilibili.com/video/BV1Ha4y1z7Co/?spm_id_from=333.788&vd_source=3d748890e07b647ea8793f10dabf8c4c)、[Asoul](https://www.bilibili.com/video/BV17T411d7DT/?spm_id_from=333.788.recommend_more_video.-1&vd_source=3d748890e07b647ea8793f10dabf8c4c)、[酷帅参考](https://www.bilibili.com/video/BV1CN41167hH/?spm_id_from=333.337.search-card.all.click&vd_source=3d748890e07b647ea8793f10dabf8c4c)、[星瞳-星引力](https://www.bilibili.com/video/BV1qe411F7Ac/?spm_id_from=333.337.search-card.all.click&vd_source=3d748890e07b647ea8793f10dabf8c4c)<br/>[国风开场参考](https://www.bilibili.com/video/BV1PG411C747/?spm_id_from=333.337.search-card.all.click&vd_source=3d748890e07b647ea8793f10dabf8c4c)<br/>[世界计划1](https://www.bilibili.com/video/BV1HmvYeCE5d/?spm_id_from=333.788.videopod.sections&vd_source=3d748890e07b647ea8793f10dabf8c4c)、[世界计划2](https://www.bilibili.com/video/BV19FpgeAEF9?spm_id_from=333.788.videopod.sections&vd_source=3d748890e07b647ea8793f10dabf8c4c) | |
| <font style="color:black;">开场2</font> | [春夏秋冬](https://www.bilibili.com/video/BV1UA4m1P7a7/?spm_id_from=333.337.search-card.all.click) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728462940872-c4654c23-4344-4e49-b493-4bddc030c5bf.png) | | |
| <font style="color:black;">开场3</font> | [一体同心](https://www.bilibili.com/video/BV17H4y1s7D9/?spm_id_from=333.999.0.0&vd_source=3d748890e07b647ea8793f10dabf8c4c) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728462968257-e3b5017f-3a05-4e48-a885-88f9ad1800dd.png) | | |
| <font style="color:black;">开场4</font> | [花戎](https://www.bilibili.com/video/BV1xx421k762/?spm_id_from=333.999.0.0&vd_source=3d748890e07b647ea8793f10dabf8c4c) | ![](https://cdn.nlark.com/yuque/0/2024/png/45413786/1728462984112-ea75c240-35d5-43a5-8d4d-0df23711fdb0.png) | | |


## 4.3特殊动作
可以先从春夏秋冬的舞蹈动作中截取。

# 五、配置表说明
# 六、功能需求清单
# 七、美术需求清单




