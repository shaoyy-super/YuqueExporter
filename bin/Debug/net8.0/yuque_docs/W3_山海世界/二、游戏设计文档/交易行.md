

## 一、概述
### 1.1 文档说明
玩家在游戏中进行交易的系统



### 1.2 文档维护
| <font style="color:white;">版本</font> | <font style="color:white;">时间</font> | <font style="color:white;">负责人</font> | <font style="color:white;">修改内容</font> |
| :---: | :---: | :---: | :--- |
| <font style="color:black;">v1.0</font> | <font style="color:black;">2024/8/9</font> | 姚仕达 | <font style="color:black;">文档创建</font> |
| | | | |


### 1.3 设计思路
设计目的说明：方便玩家在游戏中交易货物

玩法思路介绍：玩家可以在拍卖行中贩卖或者收购各种道具，在使用货币交易的时候，会收取一定的费用补充财政



### 1.4 系统框架图
![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/43733777/1723444261607-15f80d03-524d-49d1-9f42-e80dcc91b506.jpeg)



## 二、功能说明
### 2.1 名词设定
税收：玩家在交易过程中，默认会从卖家付款中扣除的一定金额



### 2.2 出售规则
a、物品上架默认时间为24h，时间到后如果未售出，物品通过邮件返还玩家

b、物品默认价格为游戏设定好的建议价格（需要数值介入），玩家上架物品时，默认显示建议价格，玩家可以手动输入除0以外的任意价格（不可输入小数点）。

b-1、根据市场价格的变动，物品的建议价格会有变化。不同种类的商品，建议价格计算方式不同。通用道具为表格配置的基础价格。宠物类为需要根据宠物的实际价值取值。

c、上架时会提示玩家需要的手续费，但手续费需要在有买家购买后，在通过邮件发放费之前扣除。手续费为固定比例，配置在表格中

c-1、剩余的玩家所获得的货币通过邮件发送给玩家

d、单次上架后的物品无论数量多少都算作为一条上架物品组。在下架和显示时，都为单独的一组。后续如果上架相同的物品不合并。

#### 2.2.1 宠物类型
a、宠物类型有出售限制条件，只有有寿命的宠物可以上架

### 2.3 购买规则
a、购买时，默认帮玩家选择物品种类下的物品。优先选择时间长价格低的物品，依次按照玩家需要的数量选择

b、玩家如果选择其他挡位，按选择的挡位为起点，按优先选择时间长价格低的物品往后按玩家需要的数量选择。

c、当玩家点购买按钮时，如果选择范围内的价格的商品剩余数量不足，则提示当前物品已售出，并刷新界面。默认选择最低价格商品，并保持玩家选择的数量不变；如果按价格高的选择的数量不足，则剩余数量往价格低的选择，如果交易行可选的总数不足，则将玩家选择的数量变为可选的最大值，并重新计算价格。

d、购买后的物品通过邮件发送给玩家

### 2.4 下架规则
a、下架会一次下架所有该此上架的所有物品，但已卖出的数量不可下架。只会下架此次售卖中的剩余物品

b、下架物品同样走邮件发送给玩家





## 三、界面说明
### 3.1 交易行主界面
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723542272016-e3d491af-c7dd-4321-9b3c-4e40e89c17f2.png)

a、点击场景中交易行功能按钮，进入交易行界面

b、最上方为返回按钮和标题栏，右侧显示玩家现在拥有的货币数量

c、主区域左侧为2列页签，第一列为交易行下的4个功能页签。第二列为不同功能内的子页签。购买界面显示游戏内所有物品分类

d、交易行默认打开购买物品界面。第二列显示为购买界面的物品种类筛选页签。

d-1、筛选页签可以有下拉子分类，根据表格配置规则读取。点击有子分类的筛选页签打开子页签展示。

d-2、点击无子分类的筛选页签，或者点击子分类。直接打开该页签对应的物品贩卖界面

d-3、子分类的层数根据配置读取，只有分类下有子分类就显示+号标记，玩家点选展开后显示-号。

e、主区域右侧为物品展示区，按一定数量展示物品，可滑动。

e-1、主界面的物品展示为合集状态，只要交易行中有此品类的物品就会显示一个合集。同一个物品只会显示一个。按id顺序显示

e-2、合集上显示：物品图标、物品名字、物品当前最低价格、收藏按钮（点击收藏后，此物品合集优先显示在最上面）、点击查看提示

f、下面为搜索框和品质筛选框，搜索框支持单文字模糊搜索。品质筛选框主要筛选物品的品质。

f-1、点击品质筛选后，在当前的页签内进行筛选，并显示筛选完的结果。切换页签后重置

f-2、点击搜索框弹出搜索界面并出现软键盘。每次输入一个文本后，以目前输入的文本为一个词，在所有物品中匹配，名字有相似的显示在预输入菜单中。

f-3、预输入菜单可滑动，滑动时默认收纳软键盘。玩家点击里面的任意物品后跳转此物品的分类并打开购买界面

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723186693244-3099b339-05bd-4a32-9c06-a01f7d8dd426.png)

f-4、有一个刷新按钮，玩家可以点击刷新当页面的显示。刷新按钮有3s的cd。

g、当选中的页签下没有任何的物品时显示为空并有文字提示

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723186826773-e6812a69-bf08-4e35-b1b5-471ca983b5d3.png)

h、如果点击时，货物交易行没有数量。则提示货物售罄。并刷新玩家界面

### 3.2 购买物品
点击任意物品合集会进入这个物品的购买界面

如果点击此合集时，该物品数量为0。则文字提示玩家：该物品售罄。并刷新交易行主界面

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724210540271-42fb3f5b-471a-4243-bc2f-c436a98b46ec.png)

a、最上方显示弹窗名字、关闭按钮

b、主区域左侧为物品列表。按从低到高依次排列，所有同价位的都整合在一条中，只显示价格和这个价格的数量。

c、当前价格挡位中有玩家选择购买的物品会有已选中的标记，如果购买的数量横跨数个价格档次，则都显示

d、右侧显示物品具体的物品信息和玩家的拥有的数量。下方为玩家的购买选项

d-1、玩家购买区域显示：玩家下一个购买会买到的最低价、购买的数量和当前选择购买数量的总单价。最下方是购买按钮

e、购买数量左右2侧的加减按钮可以点击增加数量，也可以通过点击数量框在屏幕右侧打开数字小键盘输入数字，滑动条最大为玩家可以购买的数量（金额+交易行拥有数量），输入的数字无法超过玩家可以购买的数量，如果输入数字大于可购买数量，会在玩家输入后切换成玩家可以购买的最大数量显示

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723192400178-26a04b86-0c0f-4cf6-8891-00a768fdcafd.png)

f、玩家可以自己点击标题栏右侧的刷新按钮刷新当前的物品价格信息，刷新后保持玩家选中的数量不变，重型计算总价格。如果数量小于玩家选择的数量，则将玩家选择的数量变为可选的最大值

f-1、如果玩家长时间停留，每隔3分钟，默认帮玩家点击此按钮刷新一次当前的物品价格信息

f-2、如果刷新后，交易行没有货物。则显示无道具提示。并把选择数量归零

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723447024786-d4015ec7-be5a-4e46-9b82-ea088bc4e627.png)

g、如果玩家的货币数量不足，则无法输入或者用加减按钮选择高于自己货币的物品数量。

h、如果玩家货币一个都无法购买，默认显示数量为0。如果足够，默认显示1



### 3.3 出售物品
点击出售物品页签打开出售界面

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723194340927-ed493b43-fb2b-46d7-a738-367867b08f89.png)

a、第二列和购买物品逻辑一样，这里只显示玩家已拥有的物品种类

b、右侧显示此分类下，玩家背包内的道具。默认显示：物品图标、名字、数量、和点击出售提示（不同物品种类可能有不同显示信息，根据类型区分）

c、下方的搜索和筛选逻辑和购买一致



### 3.4 出售物品弹窗
点击任意出售物品界面的道具打开出售物品弹窗

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724210762233-21c27f39-3d1f-4a77-a906-e608d9da4774.png)

a、左侧显示正在出售的该物品的市场信息，默认按价格排列，最上面一行显示最低标签。

b、右侧显示该物品的基本信息以及玩家的出售选项

b-1、右上为物品信息：显示物品图标、名字、玩家拥有的数量。和我们给出的建议零售价。

b-1、零售价为玩家出售货物的价格，默认显示我们提供的零售价。可以通过左右按钮或者点击数字框呼出数字小键盘调整。

b-2、出售数量为一次出售的数量，默认显示1，可以通过左右按钮或者点击数字框呼出数字小键盘调整

c、出售总金额，显示当前出售的物品的总价格

d、下面为出售物品按钮，按钮上方有一个交易税收的提示文本。

e、玩家可以点击标题栏右侧刷新按钮刷新物品的价格信息。并把单品价刷新为目前的最低价，如果交易行没有该物品了则归零，并显示无此道具出售。

f、点击确认出售后，弹出确认框。

f-1、显示出售的物品信息、名字和数量。下面显示出售䣌总金额。以及出售后税收提示

f-2、玩家确认后，物品上架，并返回物品出售界面

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723196595572-390c8bd9-fb66-47f8-bd1d-a7cca438066d.png)

g、交易行无此道具时显示为空并由提示文本

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723439988999-913d7871-7c2e-4bb2-980d-21cc62f20101.png)

h、物品出售后会收取税收，税收会显示在发送给玩家的收入邮件中

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723445093280-7f9e9b06-9996-40f0-adc1-fb5b4abf34af.png)



### 3.5 我的出售
点击我的出售页签打开我的出售信息界面

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724211075196-ec0b40b0-57e7-47d7-b878-88ee92d7e7c5.png)

a、主区域显示玩家正在售卖的物品信息，根据玩家上架的顺序和分类显示

b、单条物品信息主要包括：图标、名字、上架的数量信息\目前还剩余可售卖的数量、剩余时间、单价、和下架商品按钮

c、点击下架物品，会弹出确认框。提示玩家当前可下架的物品数量和下架冷却提示

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723542006707-59529345-df35-4bb2-8b2c-eb6650eab7ec.png)

d、无出售物品时，显示为空并有提示文本

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1723440107646-047d0b3f-524c-4df2-8b14-fa237c4c6987.png)



### 3.6 特殊出售物品类（宠物）
#### 3.6.1 交易行宠物
点击页签中宠物页签，会切换至宠物拍卖页面

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724140366692-49dc6cb7-ad90-472e-95a6-97886b8badba.png)

a、宠物分类按上架的宠物的年龄状态区分，分为宝宝和成年2种类别

b、选择分类后，在右侧展示区域显示所有在售的宠物的种类，同类宠物被收纳在一个按钮下。显示宠物的头像、名字、在售的数量、收藏按钮和点击提示。

b-1、点击收藏按钮激活后，收藏后的宠物在所有页面上优先显示，再次点击取消

b-2、点击容易种类，打开此种类的购买界面。

c、玩家也可以通过搜索逻辑，在当前选中的分类下搜索包括：宠物名字、技能名字。搜索后直接打开购买宠物界面。



#### 3.6.2 宠物购买列表
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724145447516-475354e7-af59-41f6-b855-17b9a5d8f68f.png)

a、左侧为宠物列表，显示宠物的头像、价格、类型和战斗力等基本信息，方便玩家初步筛选。点击价格和战斗力页签可以切换排序顺序方式，同时只存在一种排序方式。

a-1、当前选中的宠物有选中框提示，宠物类别为只可单选，默认按价格由低到高排列。

a-2、刚打开此界面时，默认选中第一个。

b、点击头像后，在屏幕中间宠物的tips，上面显示该宠物的所有信息。

c、右侧为宠物模型展示和价格显示，根据玩家选中的宠物显示价格，点击购买按钮跳转购买确认按钮

d、玩家点击购买时，如果被选中的宠物已被购买或者已下架，则提示该物品已售出并刷新玩家界面



#### 3.6.3 出售宠物
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724217405342-dc44ef7d-bdcc-4fc9-8e13-6d80faee3b71.png)

a、出售宠物中也分为宝宝宠物和成年宠物，根据宠物的类型分类。只有玩家拥有的类型才会显示出来

b、选择类型后，右侧显示该分类下玩家拥有的所有此分类的宠物

b-1、主要显示宠物的头像、战斗力、nft标记、和点击出售提示。可以点击宠物的头像出现tips，tips上显示宠物的完整信息

c、搜索框可以输入搜索该分类对应的宠物名字、拥有某技能名字的宠物

d、分类标签可以二次筛选nft类型和战斗顺序



#### 3.6.4 出售宠物列表
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724222819069-f4b4245e-9dc5-4585-8d9b-57af38f96ad5.png)

a、点击任意宠物进入出售宠物界面

b、左边为宠物列表，显示宠物头像、名字、价格、nft类型、战斗力。可以点击宠物头像查看tips显示宠物的详细信息

c、最下方为搜索框，可以对应搜索到带有具体技能名称的该品种宠物

d、右侧为售价设定区域，上面显示宠物的模型，模型下方为当前的建议零售价

d-1、下方为价格区域，显示单价框和总金额，宠物类型2者应该是一样的。默认显示当前的零售价，玩家可以用加减号或者呼出数字小键盘调整数值

d-2、最下面是出售按钮，和税收提示文本，点击后弹出确认上架提示框

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1724223004360-10be66c4-68f3-4196-ba8b-2bfd2f31657f.png)







## 四、配置表说明
### 4.1 misc表
需要一张杂项表格。里面增加拍卖时限配置、手续费金额配置



### 4.2 item表
物品分类、分类名称、是否可以拍卖、最低价格，4个字段

物品分类需要支持子分类配置（大类|二类|三类|。。。），名称直接读取



## 五、功能需求清单




## 六、美术需求清单
### 6.1、界面需求
| **<font style="color:white;">编号</font>** | **<font style="color:white;">界面</font>** | **<font style="color:white;">性质</font>** |
| --- | --- | --- |
| 1 | 拍卖行主界面 | 一级界面 |
| 2 | 购买物品弹窗 | 弹窗界面 |
| 3 | 出售物品 | 二级界面 |
| 4 | 出售物品弹窗 | 弹窗界面 |
| 5 | 出售确认、下架确认 | 弹窗 |
| 6 | 我的出售界面 | 二级界面 |
| 7 | 搜索框 | 弹窗界面 |
| 8 | 数字小键盘 | 弹窗界面 |






## 七、string需求
| **<font style="color:white;">类别</font>** | **<font style="color:white;">目标操作</font>** | **<font style="color:white;">触发条件</font>** | **<font style="color:white;">提示形式</font>** | **<font style="color:white;">提示string</font>** |
| :---: | --- | --- | --- | --- |
| | 选货物数量点击数字+-号 | 购买界面，玩家金币不足购买更多的货物 | 飘字 | 当前货币不足 |
| | 选货物数量点击数字+-号 | 购买界面，交易行货物不足 | 飘字 | 当前物品数量不足 |
| | | | | |
































































