## 变更记录
> 记录每次修订的内容，方便追溯。
>

[此处为语雀卡片，点击链接查看](https://www.yuque.com/cod5mf/iwqppn/iba4vcxvzicxgfim#FReK8)



## 1、设计思路
设计目的：主线关卡为pve关卡，有战斗或者纯剧情的形式，难度整体偏低，以引导和战斗、剧情体验为主。

玩法思路：玩家可以通过主界面的npc或者模型进入主线关卡界面。以pve得形式体验游戏最基础得战斗玩法。并获得游戏初期得基础奖励资源。奖励发放主要为一次性通关奖励，通关的关卡后续不可再次进入





## 2、关卡入口
主场景左侧一个npc，有可用的主线关卡时，有感叹号提示。有未开启条件时灰置

当玩家主线完全通关后，按钮消失。



## 3、界面需求
figma链接[https://www.figma.com/proto/2c1LfmuZHJ3PghpYq1Eywo/%E5%B1%B1%E6%B5%B7%E4%B8%96%E7%95%8C?page-id=39%3A332&node-id=1290-6436&viewport=148%2C-7035%2C0.23&t=atRULvgxU4RgsXBC-1&scaling=contain&starting-point-node-id=1290%3A6436&show-proto-sidebar=1](https://www.figma.com/proto/2c1LfmuZHJ3PghpYq1Eywo/%E5%B1%B1%E6%B5%B7%E4%B8%96%E7%95%8C?page-id=39%3A332&node-id=1290-6436&viewport=148%2C-7035%2C0.23&t=atRULvgxU4RgsXBC-1&scaling=contain&starting-point-node-id=1290%3A6436&show-proto-sidebar=1)

### 3.1、主界面


![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717491454973-2282fe06-3df0-4ba6-a5a1-73ffd3e7dc40.png)

a、左上为返回按钮，中间为标题。显示当前章节的名字

a-1、主线由多个章节构成，每个章节有数个关卡。需要配置可控制

a-2、一个章节在界面上显示为一页，完成一个章节的所有关卡后可以获得有个章节奖励。



b、中间为关卡地图区域。显示为一个完整的大地图，可跟随章节配置不同的地图资源，玩家可以点击左右按钮翻页。一页为一个章节。每个关卡有一个图标标识，并有虚线链接不同的关卡标识路线

b-1、当前位置为第一张地图时，做箭头不显示，当前位置为目前可到达的最后一张地图时，右箭头不显示

b-2、未开启的章节，无法切换查看。（章节内没有已开启的关卡时，章节未开启）

b-3、点击宝箱后，有弹出tips显示宝箱中的奖励预览。（如果奖励都为随机性质，增加一个奖励预览字段，配置对应的item参数）

b-4、宝箱预览一页2行半，一行4个。大于8个时可以上下滑动。界面的尺寸需要根据奖励数量自适应，只有1、2个时尺寸只有一行的高度。

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717580218403-9f89a786-fc45-4776-8055-9565386678d5.png)![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717580382911-4d521abe-a6e7-4de2-9b16-df1bf153f594.png)

b-5、宝箱有2种状态，未开始时为闭合的宝箱，可领取时有特效并抖动。



c、点击关卡图标为选中关卡。选中关卡后，图标变大显示，并显示的名字和通关奖励。奖励显示可以有单页的数量上限（看美术效果），当超过时，可以滑动查看。（如果奖励都为随机性质，增加一个奖励预览字段，配置对应的item参数）

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717468549570-f8b4a83f-3985-438b-9095-cf4ebf3c5f5e.png)

c-1、已完成的关卡显示一个绿色的钩，当前关卡正常显示图标，未到达的关卡不显示，且以他为终点的虚线段不显示。

c-2、解锁关卡时，虚线段逐步推进显示（美术效果），到达下个关卡位置时关卡图标显示

c-3、当前一个关卡已通关，但后一个关卡未解锁时，显示为灰态带解锁条件提示。开始按钮灰态不可点击

![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717491836878-1a30ecd8-4025-40bb-a674-55a9fadf2d56.png)

c-4、关卡小图标目前需要3种：普通关卡、boss关卡、剧情关卡。根据关卡的战斗类型调用不同的图标

d、玩家打开界面后，只会默认选中当前进度的关卡（开放和解锁），点击右下开始可以开始关卡。玩家可以切换点击之前的关卡，依旧显示名字，但不能再次战斗，开始按钮灰显不能点击

e、每个关卡图标得位置可以有配置表控制，虚线段可以是2点之前的贝塞尔曲线段（这里需要和美术协调下，考虑到美术效果也可以是直接出成资源，如果由线段方式表现，需要提供贝塞尔曲线参数）



一些参考

![](https://cdn.nlark.com/yuque/0/2024/webp/43733777/1717469089995-f5d8ae21-849c-4589-92af-baef2ebe9513.webp)

![](https://cdn.nlark.com/yuque/0/2024/jpeg/43733777/1717469087731-6dcc0478-2a0f-42bc-a1aa-3f3a01d4849c.jpeg)





## 4、功能说明
### 4.1、章节
#### 4.1.1、章节定义
a、一个章节表现为同一张地图上得数个关卡的合集，有表格控制

b、章节的配置中包括：章节名字、章节地图、背景音乐、下属关卡和奖励配置（[详见表格6-1](#FYB9S)）

b-1、背景音乐在章节切换时候，如果为同一首，不切换，延续播放。如果不为同一首，切换播放。

b-2、下属关卡配置对应的关卡表id

b-3、奖励配置奖励池的id，分2个参数，用|隔开。前面为50时奖励，后面为100时奖励。配有奖励池id则显示，配置为0不显示（0|200）

c、章节解锁：只要该章节中有任意一个关卡开放，则该章节解锁

### 4.2、关卡
#### 4.2.1、关卡流程


![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/43733777/1717498358379-4f68cf2d-ed4b-4903-90eb-6aea8e0eea76.jpeg)



#### 4.2.2、关卡解锁条件
a、关卡开放：完成上一个关卡时，下一个关卡才会开放并显示在地图上。未开放的关卡不显示

a-1、开放时先显示通关标记，然后出现路径最后出现下一关卡的图标。如果需要切换章节，将路径出现过程替换为章节切页过程

b、开放后的关卡需要满足解锁条件才能进入。初始版本需要等级和功能id 2种解锁方式。解锁条件需要同时达标才能解锁关卡。需要可配表控制。未解锁时在地图上有文字标记

c、已通关的关卡不能再次挑战。

#### 4.2.3、剧情调用
a、需要在关卡中可配置剧情id的调用

b、可配置在关卡战斗前播放 还是在战斗胜利后播放

b-1、战斗前剧情在玩家点击开始按钮后播放，直接显示剧情对话界面

b-2、战斗后剧情在玩家返回关卡界面后播放，显示剧情对话界面

#### 4.2.4、关卡阵容
a、需要可配置每个关卡的怪物阵容，以及怪物对应的技能、等级；可配置对应的场景、音乐等等。（[详见表格6-2](#v0rxs)）

a-1、关卡有战斗类型配置，战斗类型表里有默认得背景和音频配置，如果关卡表里有额外得配置，读关卡表。没有则读默认配置

a-2、需要在关卡表里配置最多3个怪物id的阵容（可以小于3，非战斗类型的关卡不用配置），出场顺序即是表格里得顺序。

<font style="color:#8A8F8D;">b、特定关卡会对玩家的阵容有一定要求，根据宠物的类型来限定（比如：种类、nft、寿命等等）在选择阵容界面就直接把不可用的宠物隐藏。初版本不需要这个功能，后续其他功能可能有扩展。</font>

c、新增战斗类型：剧情关卡。剧情关卡不调用战斗流程，在玩家进入关卡后，直接调用剧情配置。看完这段剧情后，在关卡界面上播放奖励界面。（可以和战斗前剧情配置放在一起）

#### 4.2.5、通关目标
根据战斗类型需要数种可通关方式，来丰富玩家的关卡体验，目前版本需要：

a、战斗胜利，战斗结果判定为胜利时通关。

b、剧情通关，观看完关卡所需要播放的剧情id后即可通关。

#### 4.2.6、关卡奖励
a、需要可配置完成关卡后对应的奖励组id。并在玩家完成关卡目标后发放并显示。



## 5、怪物配置
### 5-1、定义关卡怪物
a、需要一张专门的怪物表，定义用在pve中的所有的怪物的配置。怪物表中的怪物直接调用配置的数值即可。（[详见表格6-3](#jFTDH)）





## 6、表格结构
### 6-1、章节表
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717573284898-bed95e5b-1dc7-4455-b81f-8ab7adac56d5.png)

id规范：主线章节调用1001-1999



### 6-2、关卡表
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717578302716-f4bd23af-57a7-4864-8481-601ba0e32c66.png)

id规范：主线关卡（章节id+关卡数）例如：100101、100102



### 6-3、怪物表
![](https://cdn.nlark.com/yuque/0/2024/png/43733777/1717572581015-501b8c88-92dc-47ce-bd7a-2b7e32456c08.png)

id规范：主线关卡怪物id（关卡表id+怪物顺序）例如：10010101、10010102、10010103





## 7、美术需求清单
### 7.1、ui需求
| 编号 | 界面 | 性质 |
| --- | --- | --- |
| 1 | 关卡主界面 | 一级界面 |
| | | |


### 7.2、场景需求
| 编号 | 场景类型 | 场景用途 | 描述 |
| --- | --- | --- | --- |
| 1 | 关卡地图 | 关卡展示背景 | 初始制作一张通用背景即可，草原或者森林地貌 |
| | | | |




### 7.3、动效需求


| 编号 | 类型 | 界面 | 触发场景 | 描述 |
| --- | --- | --- | --- | --- |
| 1 | ui动作 | 关卡界面 | 打开主界面 | 界面展开的基础动效 |
| 2 | ui动作 | 关卡界面 | 点击章节切换按钮 | 点击按钮的基础缩放效果 |
| 3 | ui动作 | 关卡界面 | 点击开始图标 | 点击按钮的基础缩放效果 |
| 4 | ui动作 | 关卡界面 | 关卡通关标记 | 一个绿色的标记出现在关卡图标上的效果 |
| 5 | ui动作 | 关卡界面 | 下一个关卡出现 | 通向下一个个关卡的线条逐步链接，下一个关卡图标从天上掉落的动效 |
| 6 | ui动作 | 关卡界面 | 点击关卡图标 | 点击按钮的基础缩放效果 |
| 7 | ui动作 | 关卡界面 | 章节奖励宝箱解锁 | 宝箱抖动等效 |
| 8 | ui特效 | 关卡界面 | 章节奖励宝箱解锁 | 宝箱背后的背光特效提示 |
| 9 | ui动作 | 奖励展示 | 点击为解锁的宝箱 | 奖励弹窗展开动效 |
| 10 |  |  |  |  |
| 11 |  |  |  |  |






# 8、string需求
| | 操作目的 | 触发条件 | 形式 | string |
| --- | --- | --- | --- | --- |
| 关卡流程 | 开始关卡 | 关卡未解锁 | 文字 | 关卡尚未解锁 |
| | 开始关卡 | 关卡已通关 | 文字 | 关卡已经通关 |
| | | | | |
| | | | | |
| | | | | |
| | | | | |










