## 添加方法：
### 一、添加RenderFrature
![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1724292314510-c1261f65-681f-47d5-b2d2-24a62b18d999.png)

找到SceneRenderer，检查RenderFeature中是否含有Custom Shadow All In One Feature，没有的话通过下面Add Render Feature添加一个进来

红框内的Layer是默认生效的层级，即在ShadowVolume没有覆写的情况下（后面会说明ShadowVolume里怎么覆写）哪个/哪些Layer的物体可以参与自定义自阴影的计算

SceneRenderer一个项目只需要设置一次，正式制作情况下会由TA来设置



### 二、设置ShadowVolume
![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1724292986628-bc94bca3-b479-469e-90e2-7645a65fbe50.png)

在场景使用的Volume中通过Add Override加入ShadowVolume，<font style="color:#DF2A3F;">需配合</font>**<font style="color:#DF2A3F;">三、挂载脚本</font>**<font style="color:#DF2A3F;">使用</font>

**参数说明：**

**启用光源一自阴影：**启用后提供一盏可以投射自定义阴影的光源选项

**光源一光源：**可以置入一盏需要投射阴影的平行光，默认（为None）时使用场景主光源，**必须是平行光**

<font style="color:#DF2A3F;">（光源本身未启用或投影模式为不投影时不会正常投影，发现某光源不生效时注意光源设置）</font>

**光源一自阴影强度：**光源一投射阴影的强度，取值范围0-1，值越小阴影越淡，<1时会出现漏光问题

**光源一自阴影范围线框显示：**启用后会线框显示光源一投影范围，以及投影物体的投影用包围盒

![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1724294882306-ad8905a4-f8e5-454b-85c1-6c19b2e2c801.png)

根据投影物体位置和投影物体Bound大小动态计算出一个最小投影范围以提高阴影精度，开启线框显示后可以帮助判断需要投影的物体是否都被纳入阴影计算 / 投影物体Bound大小是否正确设置



**启用光源二自阴影：**启用后提供第二盏可以投射自定义阴影的光源选项

**光源一光源：**可以置入一盏需要投射阴影的平行光**或聚光灯**，默认（为None）时不生效

**光源一自阴影强度：**光源二投射阴影的强度，取值范围0-1，值越小阴影越淡，<1时会出现漏光问题

**光源一自阴影范围线框显示：**启用后会线框显示光源二投影范围，以及投影物体的投影用包围盒



**自阴影生效范围：**物体到摄像机的距离超过这个值时会被剔除，不再计算阴影（值越大，可能包进去的物体范围就越大，相应的阴影精度就会越低）

**重载生效Layer：**覆写RenderFeature Layer设置，使用该ShadowVolume的场景中哪些Layer的物体会纳入投影的计算

使**用NdotL光照：** 默认开启，开启时能根据法线计算出更柔和的阴影（非软阴影），默认开着就好

### 三、挂载脚本
![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1724295276266-a2cb0d8a-197d-491f-9891-4208192faf01.png)

在需要投射自定义阴影的物体上挂载CustomShadowController脚本，配**合二、设置ShadowVolume中**的**自阴影范围线框显示**调整物体投影包围盒的大小和位置

**BoundRadius**用于调整物体投影包围盒的大小

**PositionBias**用于调整物体投影包围盒的位置

其他参数目前无需调整

![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1724295572168-4794895e-9316-42e0-83f9-ca1ab29008f0.png)

仅需在最上的层级挂载一次

![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1724295608364-d8085581-27ad-49ec-99c1-edb04c9ab612.png)

预制件中不好直接设置（没有ShadowVolume配合），可以在场景中调完后Apply回去



### 四、适用Shader
