![](https://cdn.nlark.com/yuque/0/2024/png/46024715/1721042368732-e0a84002-b8a0-482d-9238-9b30d9222415.png)



Global Settings: 

**_阴影质量等级：**Enum：1.高   2.中   3.低;   具体对应分辨率待测试（URP，角色场景阴影，角色自阴影）

**_使用烘焙阴影：**

**_环境投影用LOD等级：**1.LOD0   2.LOD1   3. 最低档LOD

**_角色投影用LOD等级：**1.LOD0   2.LOD1   3. 最低档LOD

****

Mode Select:

**_模式预设：** Enum： 1. 展示 2.固定场景 3.开放世界















### case 2. 固定场景
**_URP阴影范围：**0.5(暂定) ~ 1

**_角色对场景投影(B)：**

        True: 

                角色开启URP阴影

**_角色自阴影(B)：**

**      **  True: 

          **       _自阴影颜色：**

               **  _自阴影强度：**

                 **_自定义自阴影角度(B)：**

                          True: 

                                   **_自阴影角度:**



































































### case 2. 固定场景（弃）
挂载脚本List设置： Enum: 1. 角色 2. 给角色投影的物体 3. 受角色投影的物体



**_环境阴影颜色：**

**_环境阴影强度：**

**_阴影质量等级：** Enum：1.高   2.中   3.低;   具体对应分辨率待测试（URP，角色场景阴影，角色自阴影）

**_投影用LOD等级：**Enum： 1.全局   2.拆分角色

        **_全局投影用LOD等级：** 1.LOD0   2.LOD1   3. 最低档LOD

        case 2.拆分角色

                **_角色投影用LOD等级：**1.LOD0   2.LOD1   3. 最低档LOD

**_URP阴影范围：**0.5(暂定) ~ 1

**_角色对场景投影(B)：**

        True: 

                记录LocalBool: bCharaCastShadow = true

                **_高精度投影 or URP投影(B):**

                       True: 记录LocalBool: bCharaCastCustomShadow = true

                       False: 记录LocalBool: bCharaCastCustomShadow = false

**                _场景对角色投影(B)：**

                True: 

                        记录LocalBool: bEnvCastShadowOnChara = true

                         **_高精度投影 or 整体投影(B): **bCharaCastCustomShadow = false时，强制走False整体投影

                                 True: 记录LocalBool: bEnvCastCustomShadow = true

                                 False: 记录LocalBool: bEnvCastCustomShadow = false

                False: 

                        记录LocalBool: bEnvCastShadowOnChara = false    

        False: 

                记录LocalBool: bCharaCastShadow = false    

**_角色自阴影：**

![](https://cdn.nlark.com/yuque/0/2024/png/45354151/1721024003951-ce0313cb-5e46-4605-8410-8c01f7f86cbb.png)

（角色阴影再拆可以拆成环境阴影和角色自阴影，上述内容旨在计算环境阴影部分，这里再提供一个是否添加角色自阴影的选项）

**        **True: 记录LocalBool: bSelfShadowOn = true 

          **       _自阴影颜色：**

               **  _自阴影强度：**

                 **_自定义自阴影角度(B)：**

                          True: 记录LocalBool: bCustomSelfShadowAngle = true 

                                   **_自阴影角度:**

**                      **    False: 记录LocalBool: bCustomSelfShadowAngle = false, 自阴影角度取平行光角度

                                    



（以上LocalBool为文档演示专用，意在提高下文判断的可读性，在实际代码中会直接读对应开关的value）

判断：

```plain
if (bCharaCastShadow)
{
    if(bEnvCastShadowOnChara)
    {
        if(bCharaCastCustomShadow && bEnvCastCustomShadow)
        {
            //投影范围根据List中Enum为角色的物体动态计算得出
            //List中所有Enum物体均投影（计算深度）
            //角色不投URP
            //List中Enum为接收角色投影的物体需要混合自定义投影与URP阴影
        }
        else if (bCharaCastCustomShadow && !bEnvCastCustomShadow)
        {
            //投影范围根据List中Enum为角色的物体动态计算得出
            //List中Enum为角色和接收角色投影的物体投影（计算深度）
            //角色不投URP
            //List中Enum为接收角色投影的物体需要混合自定义投影与URP阴影
           //角色环境阴影走AverageShadowTestPass做整体阴影
                    if(bSelfShadowOn && !bCustomSelfShadowAngle)//优化项
                    {
                        //角色环境阴影与自阴影范围相同，移除自阴影投影计算，直接使用角色环境阴影范围作为自阴影区域
                    }
                }
                else if (bCharaCastCustomShadow && !bEnvCastCustomShadow)//角色投URP阴影时环境阴影强制走整体阴影
                {
                    //不再使用高质量阴影，角色改投URP阴影
                    //角色环境阴影走AverageShadowTestPass做整体阴影
                }
            }
            else
            {
                if(bCharaCastCustomShadow)
                {
                    //投影范围根据List中Enum为角色的物体动态计算得出
                    //List中Enum为角色和接收角色投影的物体投影（计算深度）
                    //角色不投URP
                    //List中Enum为接收角色投影的物体需要混合自定义投影与URP阴影
                    if (bSelfShadowOn && !bCustomSelfShadowAngle)//优化项
                    {
                        //角色环境阴影与自阴影范围相同，移除自阴影投影计算，直接使用角色环境阴影范围作为自阴影区域
                    }
                }
                else
                {
                    //不再使用高质量阴影，角色改投URP阴影
                }
            }
        }

```











