<font style="color:#333333;background-color:#FFFFFF;">MagicaCloth 与 Unity DOTS（面向数据的技术栈）配合使用。</font><font style="color:#333333;">  
</font><font style="color:#333333;background-color:#FFFFFF;">因此，</font><font style="color:#DF2A3F;background-color:#FFFFFF;">仿真性能完全取决于 CPU</font>

<font style="color:#333333;background-color:#FFFFFF;">性能检测工具</font><font style="color:#333333;background-color:#FFFFFF;">UnityProfile</font><font style="color:#333333;background-color:#FFFFFF;">，在时间轴上显示为</font><font style="color:#333333;background-color:#FFFFFF;">MagicaManager</font><font style="color:#333333;background-color:#FFFFFF;">块</font>

### <font style="color:#333333;background-color:#FFFFFF;">插件里面的功能模块性能对比</font>
![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721787924719-6a045410-e02d-459d-a262-e3074cb18e9b.png)

![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721787950817-fade694d-6ddf-49b3-a49a-9fbf8ccbc252.png)

### <font style="background-color:#FFFFFF;">动态创建布料数据延迟问题，使用预构建</font>
运行时构建和预构建比较

![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721736024978-1917eb86-db2d-4513-a80c-b21dd7d497f5.png)

<font style="color:#333333;background-color:#FFFFFF;">预构建数据创建本身很容易，只需按一个按钮即可完成，但有一些要点需要注意。</font><font style="color:#333333;background-color:#FFFFFF;">  
</font><font style="color:red;background-color:#FFFFFF;">它非常容易受到资源变化的影响，数据很容易变得无法使用。</font><font style="color:#333333;background-color:#FFFFFF;">  
</font><font style="color:red;background-color:#FFFFFF;">例如，当布料数据中的网格顶点数与实际网格的顶点数不匹配时，这适用。</font><font style="color:#333333;background-color:#FFFFFF;">  
</font><font style="color:red;background-color:#FFFFFF;">因此，如果出现以下因素，则需要重做生成。</font>

+ <font style="color:#333333;background-color:#FFFFFF;">如果更改了参数</font>
+ <font style="color:#333333;background-color:#FFFFFF;">当引用网格的结构发生变化时</font>
+ <font style="color:#333333;background-color:#FFFFFF;">当引用的 Transform 的结构发生更改时</font>



### <font style="background-color:#FFFFFF;">强烈建议在打包时使用 IL2CPP</font>
<font style="color:#333333;background-color:#FFFFFF;">这是因为与 Mono 相比，C# 的处理速度大大提高。</font>

打包的时候启用Burst，默认开启

### 组件放置位置（角色Gameobject根节点下）
和多线程处理有关系（<font style="color:#333333;background-color:#FFFFFF;">DOTS 还使用多线程来读取和写入Transform</font>）

世界惯性测量方法需要

### 相机剔除
![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721787077624-d8b088bb-075d-44e8-afa2-35b17cbdbfac.png)

![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721735772743-54ca73f6-617d-4351-b002-a6f9ae7731d6.png?x-oss-process=image%2Fformat%2Cwebp)

<font style="color:#333333;background-color:#FFFFFF;">当 Animator 的剔除模式为“剔除更新变换”时，当角色再次出现在屏幕上时，可能会暂时显示禁用模拟的姿势。</font><font style="color:#333333;">  
</font><font style="color:#333333;background-color:#FFFFFF;">这是因为动画师的剔除是在渲染过程中确定的，并且姿势会动态写入变换，从而覆盖模拟结果。</font><font style="color:#333333;">  
</font><font style="color:#333333;background-color:#FFFFFF;">这是一个 Unity 规范，很遗憾无法避免。</font>

![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721787130363-a66e8256-9c1c-4218-8f7a-8375063321f8.png)

### 距离剔除 
<font style="color:#DF2A3F;">2.9.1版本没找到这个功能，看了下更新文档，2.10版本有了，但是不能确定优化效果是否真的有效</font>

### 简化代理网格控制参数
![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1722241808524-268d5b55-dca2-47e8-b514-fbe57db4a3b8.png)

只有布料类型为网布可以采用，但是网布不建议用在移动端

网布使用的代理网格模拟数据，所以代理网格简化，可以优化负载

### 碰撞检测
<font style="color:#DF2A3F;">一般使用点碰撞，如果点碰撞出现了穿透问题，再考虑使用边缘碰撞。</font>

<font style="color:#DF2A3F;">自碰撞不建议使用，问题较多，不稳定</font>

<font style="color:#DF2A3F;">相互碰撞性能负载高，尽量不用</font>

### MagicaSettings 设置
通常用脚本API修改，不过也可以通过<font style="color:#333333;background-color:#FFFFFF;">CreateOther/MagicaCloth2/MagicaSettings添加到游戏对象上直接修改。</font>

![](https://cdn.nlark.com/yuque/0/2024/png/46334471/1721735794910-e3840478-6257-447f-a6e8-802be9a47211.png)

**刷新模式：**什么时候发送组件内容到系统（On Awake：创建组件时，仅发送一次；On Frame：每一帧都发送）

**模拟频率：**每秒运行模拟的次数（与精度有关，负载也是）

**每帧最大模拟次数：**与负载有关系

**初始化时机：**<font style="color:#333333;background-color:#FFFFFF;">模拟在 MagicaCloth 组件的 Awake/Start 中初始化</font>

**<font style="color:#333333;background-color:#FFFFFF;">更新时机：</font>**<font style="color:#333333;background-color:#FFFFFF;">模拟在</font>**<font style="color:#333333;background-color:#FFFFFF;">AfterLateUpdate/BeforeLateUpdate</font>**<font style="color:#333333;background-color:#FFFFFF;">运行。</font>**<font style="color:#333333;background-color:#FFFFFF;">延迟更新</font>**<font style="color:#333333;background-color:#FFFFFF;">  
</font><font style="color:#333333;background-color:#FFFFFF;">之前模拟在后期更新之前运行，使用 2DAnimation 时，这是必需的</font>

### 改进网格缩减算法---GPU支持
这个就是修改插件底层算法了，插件作者已经在改进优化算法了，但是没说什么时间更新

### 节点属性设置
<font style="color:rgb(25, 27, 31);">在制作过程中尽可能地减少Move和Fixed节点是最有效的降低物理模拟耗时的方法</font>

<font style="color:rgb(25, 27, 31);"></font>





<font style="color:#333333;background-color:#FFFFFF;"></font>

