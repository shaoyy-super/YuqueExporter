## 轨道顺序规范：
Ani Group 从上至下：

控制owner的位移轨道BattleMove

控制target的位移轨道BattleMove

控制owner的动作轨道AnimatorV2

控制target的动作轨道AnimatorV2（击飞击倒）

摄像机轨道V2/Focus

Turn to轨道

隐藏战员HidePet轨道

隐藏血条HideHp轨道

震屏Camera Shake

## 1. 动画轨道：
| 轨道名 | Mole Animator V2 Track |  |  |
| :--- | :--- | --- | --- |
| 用途 | 该轨道在动作播放结束后维持当前动作状态，使得衔接下一个动作时播放连贯正常。目前默认使用该轨道作为动画轨道。 |  |  |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943556071-509b6e65-d99f-4507-b2f9-5f8bcd8fdb1b.png) |  |  |


## 2、普攻
| TML分段 | 一段TML完成整个表演 |
| :--- | :--- |
| 出场点 | 在出场的默认站位不动 |
| 移动&攻击 | 近战：从默认站位，径直移动到目标身前一定距离处停下，进行攻击表演；<br/>远程：从默认站位，转身朝向目标，进行攻击表演 |
| 攻击返回 | 攻击结束后，站位、朝向都要还原到开始前的状态 |


| 用途 | 位移 |
| :--- | :--- |
| 轨道名 | MoleBattleMove |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943556308-55eef31a-4a2f-4f1b-b224-71bb5b9de441.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943556515-ba39ef1f-e00b-4612-a085-276fdddb4402.png)<br/>偏移向量-Z：移动停止时，到Target的距离 |


| 用途 | 转向 |
| :--- | :--- |
| 轨道名 | MoleTurnTo |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943556732-c18f4319-4d62-4529-9613-dd75c2518fed.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943556925-e2c7e50f-a6b5-4020-a8c3-a1b866ee7c67.png) |




## 3、小技能
| TML分段 | 通常分3段：<br/>1. Basic部分，负责移动+攻击+后摇<br/>2. Attack部分，位置不动直接攻击。这一段衔接Basic，是在目标身前攻击的。<br/>3. Return部分，从目标身前返回到自己的站位处<br/>个别特殊的技能，也可以只做一段完整的 |
| --- | :--- |
| 出场点 | 在出场的默认站位不动 |
| 移动&攻击 | 地面<br/>+ 近战：从默认站位，径直移动到目标身前一定距离处停下，进行攻击表演；<br/>+ 远程：从默认站位，转身朝向目标，进行攻击表演 |
|  | 空中<br/>+ 近战：通常是从默认站位，先移动到空中，再径直移动到目标身前一定距离处停下，进行攻击表演；<br/>+ 远程：与近战相似，只是到目标的距离要远一些 |
| 攻击返回 | + 分3段时，只在Return段做一个单独归位处理，所以每段TML都是不需要返回的<br/>+ 只有1段时，同普攻 |


| 用途 | 攻击前【位移】（向上，向前） |
| --- | :--- |
| 轨道名 | MoleBattleMoveV2 |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943557157-7fa5c8e2-082e-46d5-b8fc-0e0f32899338.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943557361-ffe318d3-649e-441e-a293-461c587011a9.png)<br/>一条轨道放两个Clip，完成向上->向前 |
|  | **向上：**<br/>![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943557548-4411d57f-c267-48d2-8501-a690ae63126a.png)<br/>偏移向量-Y：向上移动的高度（弃用）<br/>**当前高度直接由动作确定高度**<br/>偏移向量-Z：与敌方之间的距离 |
|  | **向前：**<br/>![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943557746-35675f12-fd3c-4075-a53d-a78b698dee6b.png)<br/>+ 为了保证攻击者高度不变，【偏移目标类型】选(Y用Sel)f；<br/>【End Pos Timing】选(Every Clip Start)<br/>+ 【Ease In Duration】做移动过程，瞬移的可以用0<br/>+ 分段制作的TML，要保留移动后位置，需要勾选【Leave As Is】 |


| 用途 | 攻击前【转向】目标 |
| :--- | :--- |
| 轨道名 | RSTurnTo |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943557989-dbf840a2-bff5-4e83-9b44-61eb1b0a7297.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943558246-94edcd5a-28bb-4f8d-ac87-552330b85d4d.png) |


| 用途 | return时【位移】归位 |
| :--- | :--- |
| 轨道名 | RSBattleMove |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943558459-d8c1d88c-0841-4604-946f-69ee7b842ed4.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943558729-90038dd6-edab-4ee9-a835-86df038a3d33.png)<br/>归位的坐标，要从逻辑中动态设置，因此【Move Target】要选(移动到指定的世界坐标)，同时偏移勾选【Use Dynamic】参数使用(BattleMovePos)<br/>编辑器中预览时可以设置【Offset】指定移动后的坐标，该模式下，运行时Offset无效。<br/>移动后位置要保持住，需勾选【Leave As Is】 |


| 用途 | return时【转向】回归自己的初始朝向 |
| :--- | :--- |
| 轨道名 | RSTurnTo |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943558930-85950948-e395-4ea5-8cd1-87b2c8916c63.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943559132-3484be11-bd31-4dda-91b7-0aac882b363e.png)<br/>朝向还原，没办法只通过TML得到正确的朝向，因此需要逻辑中动态给每个单位设置朝向，因此要勾选【Use Fixed Orientation】与【Use Dynamic】，参数Key使用（PetBornOrientation）。<br/>TML在编辑器中预览时，可以在【Offset】中设置最终朝向。 |




## 4、强击
没特殊用法，同【普攻】



## 5、人灵技
| TML分段 | 一段TML完成整个表演 |
| --- | :--- |
| 出场点 | + 寄灵人：在场上的原始站位不动<br/>+ 守护灵：创建在与寄灵人相同的位置上 |
| 表演 | 寄灵人(主要过程)：<br/>近战：从默认站位，径直移动到目标身前一定距离处停下，进行攻击表演；<br/>远程：从默认站位，转身朝向目标，进行攻击表演 |
|  | 守护灵：<br/>过程完全由TML控制，一般近战技能是开头隐藏，中间渐变出来攻击；<br/>远程可能是瞬间移动到寄灵人身旁的某个位置再做其他表演。 |
| 攻击返回 | 寄灵人攻击结束后，站位、朝向都要还原到开始前的状态<br/>守护灵：攻击完后，要隐藏掉 |
| TML控制角色 | + Owner：攻击者 - 寄灵人<br/>+ Target：受击者<br/>+ Index - 0：攻击方的守护灵 |


TML的整体做法跟【普攻】相同，只是多加了一个角色（守护灵）

| 用途 | 守护灵结束后隐藏 |
| :--- | :--- |
| 轨道名 | MoleHideActor |
| Track主要参数设置 | 无 |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943559338-0be43c70-4228-4541-a697-0a69db6f398d.png) |


| 用途 | 守护灵设置出生位置 |
| :--- | :--- |
| 轨道名 | MoleBattleMove<br/>如果对设置位置的时机有要求，可改用MoleBattleMoveV2 |
| Track主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943559536-e36ed65d-c0ae-45a0-a6df-e974a019d4f4.png) |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943559727-c3281143-9432-46e6-8d50-20c057e1db10.png)<br/>通常守护灵出生在寄灵人周围，所以【偏移目标类型】选择（相对于自己），这里"自己"就是TML的（Owner），也就是寄灵人。<br/>【偏移向量】是相对于寄灵人的坐标 |




## 6、特殊融合
| TML分段 | 两条TML同时播放、时长相同190帧（156帧处核心表演要结束）<br/>（不算分段）<br/>寄灵人：使用固定TML（TML_fuse_01）<br/>守护灵：每个灵有自己的专属TML |
| :--- | :--- |
| 出场点 | 人、灵出场坐标重合，都是用场上寄灵人的位置 |
| 表演 | 错位表演：先寄灵人表演，然后特效遮蔽，守护灵出场表演 |


| 用途 | 隐藏单位 |
| :--- | :--- |
| 轨道名 | MoleHideActor |
| Track主要参数设置 | 无 |
| Clip主要参数设置 | ![](https://cdn.nlark.com/yuque/0/2024/png/22817384/1713943559919-a8270a46-cb00-4e9c-8d93-98569a48da6a.png)<br/>两条TML隐藏单位时【Target】都选（SELF） |




## 7、追击
| TML分段 | 一段TML完成整个表演 |
| :--- | :--- |
| 出场点 | 根据攻、守方站位，动态选择出场点，具体站位参考下面文档<br/>[thoughts 文档](https://thoughts.teambition.com/workspaces/5ef1a751f60ea9001bd606cc/docs/61ee4441ce567600013b70a9) |
| 移动&攻击 | 从出场点，径直移动到目标身前一定距离处停下，进行攻击表演；<br/>或者通过镜头实现复杂的表演效果 |
| 攻击返回 | 攻击结束后，后撤+渐变隐藏，要返回初始位置<br/>程序在TML播放结束后，会彻底隐藏守护灵 |




## 8、献祭
| TML分段 | 一段TML完成整个表演，通过Buff播放 |
| :--- | :--- |
| 出场点 | 寄灵人当前的位置 |
| 移动&显示 | 守护灵需要移动到当前寄灵人附近<br/>守护灵要先显示出来，表演完成后再隐藏 |
| Actor说明 | Owner Actor（SELF）：寄灵人<br/>Target Actor（TARGET）：守护灵 |


