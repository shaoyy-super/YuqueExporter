# 概述
## 文档说明
+ 本文档说明了城市系统的功能和界面、场景设计。

## 文档维护
| <font style="color:white;">版本</font> | <font style="color:white;">时间</font> | | <font style="color:white;">负责人</font> | <font style="color:white;">修改内容</font> |
| :---: | :---: | --- | :---: | :--- |
| <font style="color:black;">v1.0</font> | <font style="color:black;">2024/06/17</font> | | 陆晓笛 | <font style="color:black;">文档创建</font> |
| <font style="color:black;">v1.1</font> | <font style="color:black;">2024/11/5</font> | | 王灼民 | <font style="color:black;">设定规则修正</font> |
| <font style="color:black;">v1.2</font> | <font style="color:black;">2024/11/21</font> | | 王灼民 | <font style="color:black;">表现设定修正</font> |


## 设计思路
![](https://cdn.nlark.com/yuque/0/2024/png/43554293/1718606201189-dc63425f-4ca7-4a72-aa41-f279b6907e74.png)

**<font style="color:#DF2A3F;">城市系统解锁流程一览图</font>**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/45603655/1734078934143-eb86aa62-2b34-4641-a5fa-402478210efc.jpeg)

# 功能说明
## 世界地图
### 地图场景概述
地图场景目前根据世界观修正为玩家在一个星球体上进行关卡的切换。玩家通过点击星球上各个区域进入城市界面，选择城市进入主城。地图场景分为城市场景，区域场景，星系场景，宇宙场景

+ 城市界面：玩家在城市界面可以看到当前区域的5个城市，有建筑物模型的中央位置城市是玩家当前所在的主城。其他4个城市以UI的形式展示，5个城市位置不跟随区域变化改动，为固定位置。
+ ![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1732173447614-c0d2331b-2085-4c7b-aa32-a0530be87700.png)示意图展示镜头角度，球体角度
+ 玩家每次完成一个城市内全部的建筑，即可解锁下下一个城市。每个城市完成后会有相对应的奖励：骰子与金钱。
+ 玩家每前往下一个攻略的城市，星球转动让攻略城市变为图中东京位置，然后东京被转动走，建筑消失，攻略城市的建筑出现。<font style="color:#DF2A3F;">（此处包含剧情系统中的城市解锁之间的动画表现）</font>
+ 城市系统的背景球体贴图会根据区域的不同变化，核心：为背景图需玩家无法与现实的地理位置进行对应上。
+ 城市系统向区域界面镜头变化过程中有特效遮掩。例如特效云层。
+ 玩家在城市界面可以通过双指缩放进入上级区域界面。（目前仅可以通过缩放进入区域，点击非城市模型以及ui无效操作）
+ 玩家城市界面可以点击城市UI与城市建筑进入主城。进入过程用loading图形式。
+ 城市界面未解锁的城市UI有灰现以及锁定标志。
+ 城市与城市之间具备路线表现，用来帮玩家理解城市前后顺序。
+ 点击已完成城市，可以进入已完成城市的回看模式。【下面有单独设定】
+ ![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1732178070997-79fb45e1-4d01-46e9-bf45-aa45db4cebd6.png)
+ 当玩家处于当前区域的最后一个城市时，界面上新增下一个区域的UI表现。
+ 当玩家不处于自己主城所在城市界面时，新增一个回城按钮，可以一键快捷回到玩家当前主城所在的城市界面。此按钮回城无需镜头，可以直接以特效遮掩，切换场景。
+ **备注：可参考的部分游戏城市解锁画面**：

[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#bGbmr)

—————————————————————— 

+ 区域界面：5个城市归属1个区域。玩家在区域界面可以通过触摸形式滚动球体，查看球体上各个区域地点。<font style="color:#DF2A3F;">玩家当前所在主城所在区域显示当前城市建筑</font>。
+ ![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1734078592925-bd2ae6cf-bde9-433e-8834-7fd372855f31.png)
+ 区域界面点击区域UI，进入城市界面，中间镜头效果与场景动画核对。（已讨论核定具体动画效果）
+ **解锁流程：**完成区域内最后一个城市→播放区域完成动画→世界地图播放下一区域解锁动画，镜头推至新区域→新区域内解锁新城市——直接进入新城市地图。
+ 未解锁区域UI有灰显与锁的标志。
+ <font style="color:#DF2A3F;">区域界面存在部分特殊物体区域</font>，例如地球旁边的空间站，空间站点击后，镜头切换空间战为主题，同时空间站也可进行触摸转动，空间站上也有区域点，具备相同的地球逻辑。
+ 区域界面进行双指放大操作，则自动进入玩家选中的区域的城市界面。点击区域UI也可进入选中区域的城市界面。
+ 每完成一个城市即可累计1点区域当前进度值，完成当前区域全部城市变为5/5，若玩家不领取，前往下个区域继续解锁城市，则保持5/5，后台保持记录，等玩家领取后，立刻跟进到当前进度。
+ ![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1734078547007-e11c0cf5-a666-47fe-a209-bc5c2bcd0126.png)

—————————————————————— 

星系界面：区域上层界面【暂未补充】

宇宙界面：星系上层界面【暂未补充】

——————————————————————

城市界面与区域界面切换效果参考视频

[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#cGq5E)

### 世界地图功能解锁
+ 默认第一个区域时无法进入世界地图，当完成第一个区域建设时，解锁世界地图的访问。
+ 城市界面每个城市的解锁，区域界面每个区域解锁，以及后续的星系解锁，宇宙解锁在解锁时候都具备解锁动画，动画表现形式与世界观，剧情相关。
+ 新增区域界面解锁逻辑：玩家创建账号后只有初始城市，此时进入城市界面无法通过缩放进入区域界面。只有完成初始区域的5个城市，需要去下个区域在解锁演绎后才可以在城市与区域界面来回切换。
+ 区域与星系界面，星系与宇宙界面同理。
+ 此逻辑包含ui层面，玩家初始号城市界面没有切换到区域的ui按钮（ui文字解释也有此备注）。![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1734078519928-da3dbca3-40af-40c4-bf47-ed7785d72d17.png)
+ 使用ui进行城市，区域，星系等界面切换同样具备镜头转化。

### 场景展示和玩家操作（待场景确定）
+ 进入世界地图后默认视角焦距当前玩家所在区域的城市界面。

### 镜头规则（待场景确定）
+ 整体的镜头效果和参数与场景，动画进行想过核对，
+ **<font style="color:#DF2A3F;">11月21当前版本效果示意视频：</font>**

[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#Qouwd)

## 奖励内容
### 城市建设奖励
+ 每建设完成一定数量的城市，设置可领取的奖励。
+ 其中每建设完成一个区域，提供更好的奖励。

### 城市奖励
+ 即为建筑系统中，每个城市建设完毕后所得的奖励。

## 排行榜入口
+ 待后续排行榜功能接入

## 主线剧情
+ 在城市系统中穿插主线剧情，具体设计参照[剧情系统 (yuque.com)](https://snh48group.yuque.com/zdlwma/kxyozs/abzip59kxuifc29g)。

## 返回已建设城市
1 在地图界面，玩家可以返回自己修建完成的城市，此界面为单独的特殊城市界面，界面上不会和主界面一样存在各类功能与活动的入口，投骰子等UI。只保留棋盘与场景建筑，棋盘上无棋子。

![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1730970892737-290fe6e0-6b3d-4d81-9a5a-187f78942caa.png)

图中所示意，当前返回到曾经的城市，只需要建设好的城市与棋盘建筑，左上角城市名称，返回按钮。

![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1730975169138-528e045c-d53f-4b3a-9353-740beb5daea7.png)

2 此界面保留主城界面，玩家可以手动拉近，拉远镜头操作。

# 界面说明
## 入口
![](https://cdn.nlark.com/yuque/0/2024/png/43554293/1718707170414-84353d76-de22-42bf-9678-aea1934ff21b.png)

导航栏中点击地图，进入区域地图展示。

## 界面
### 世界地图界面
<font style="color:#DF2A3F;">12月12日版本界面图</font>

![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1733983084830-f733c692-b7a4-42de-8191-0a7b271f71f2.png)

![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1733983109733-6969c32d-f37b-4e98-ad86-9168351483f6.png)

![](https://cdn.nlark.com/yuque/0/2024/png/45603655/1733983116902-74b83907-dacb-4123-989e-3eaeac59ba7e.png)

**切换效果参考视频：**

[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#UMqY0)



[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#pOBAo)

[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#C4MyX)

[此处为语雀卡片，点击链接查看](https://www.yuque.com/zdlwma/kxyozs/zggu4hp4ucy542d9#euCMw)

# 配置表说明
新增CityMap表

[City.xlsm](https://snh48group.yuque.com/attachments/yuque/0/2024/xlsm/43554293/1718780242118-dd898202-4f29-4145-b7c3-2ea28635357a.xlsm)

# 功能需求清单
| **<font style="color:white;">序号</font>** | **<font style="color:white;">分类</font>** | **<font style="color:white;">优先级</font>** | **<font style="color:white;">需求描述</font>** | **<font style="color:white;">自检</font>** | **<font style="color:white;">确认</font>** | **<font style="color:white;">备注</font>** |
| :---: | --- | --- | --- | --- | :---: | :---: |
| <font style="color:black;">1</font> | 入口 | 1 | 通过导航栏入口进入区域地图 | <font style="color:black;"></font> | <font style="color:black;">0</font> | |
| <font style="color:black;">2</font> | 城市地块 |  | 城市地块逻辑 | | | |
| <font style="color:black;">3</font> | 区域地图 |  | 区域地图场景显示逻辑 |  | | |
| <font style="color:black;">4</font> | 区域地块 |  | 世界地图中区域逻辑 |  | | |
| <font style="color:black;">5</font> | 世界地图 |  | 世界地图场景显示逻辑 | | | |
| <font style="color:black;">6</font> | 城市建设奖励 |  | 城市建设奖励逻辑 | | | |
| <font style="color:black;">7</font> | 功能按钮 |  | 功能按钮跳转 | | | |


# 美术需求清单
## 界面需求
| **<font style="color:white;">编号</font>** | **<font style="color:white;">界面</font>** | | |
| :---: | --- | --- | --- |
| <font style="color:black;">1</font> | <font style="color:black;">区域地图界面</font> | | |
| <font style="color:black;">2</font> | <font style="color:black;">世界地图界面</font> | | |


## 动效需求
## 场景需求
| **<font style="color:white;">所属系统</font>** | **<font style="color:white;">场景类型</font>** | **<font style="color:white;">场景名称-美术</font>** | | **<font style="color:white;">场景用途</font>** | | | **<font style="color:white;">描述</font>** |
| :---: | :---: | :---: | --- | :---: | --- | --- | :---: |
| <font style="color:black;">区域地图</font> | <font style="color:black;">地图场景</font> | | | <font style="color:black;">展示区域场景，展示城市地块</font> | | | <font style="color:black;">待定，具体待风格和世界观完善</font> |
| <font style="color:black;">世界地图</font> | <font style="color:black;">地图场景</font> | | | <font style="color:black;">展示多个区域</font> | | | <font style="color:black;">待定，具体待风格和世界观完善</font> |


## 模型需求
| **<font style="color:white;">分类</font>** | **<font style="color:white;">名称</font>** | **<font style="color:white;">用途</font>** | **<font style="color:white;">美术需求</font>** | | | **<font style="color:white;">动作需求</font>** | | **<font style="color:white;">动作名</font>** | **<font style="color:white;">特效需求</font>** |
| :---: | :---: | :---: | :---: | --- | --- | --- | --- | :---: | :---: |
| <font style="color:black;">城市地块</font> | <font style="color:black;">CityLand</font> | <font style="color:black;">区域地图中展示城市</font> | <font style="color:black;">不同风格的城市地块，对应建筑系统中的城市场景</font> | | | <font style="color:black;">  城市地块模型待机</font> | | <font style="color:black;"></font> |  |


# String需求
| **<font style="color:white;">类别</font>** | **<font style="color:white;">目标操作</font>** | **<font style="color:white;">触发条件</font>** | **<font style="color:white;">提示形式</font>** | **<font style="color:white;">提示string</font>** | **<font style="color:white;">stringID</font>** |
| --- | --- | --- | --- | --- | :---: |
|  |  |  |  |  | |
| <font style="color:black;"></font> |  |  |  |  | |
| <font style="color:black;"></font> |  |  |  |  | |


