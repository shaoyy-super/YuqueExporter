## 基本构成（服务器目录结构）
server目录下

+ ├─3rdparty 项目引用基础库
+ ├─bin 服务器的执行文件
+ ├─config 服务器相关配置
+ ├─db 服务器数据库相关配置以及脚本
+ ├─etc 服务器业务配置
    - ├─ normal 各个版本的游戏内容配置
    - ├─ pb 存储相关的pb文件
    - ├─ proto 协议相关的pb文件
    - └─ string 语言相关
+ ├─lib 第三方基础库
+ ├─package 服务器打包目录
+ ├─script 业务脚本目录
+ ├─src 服务器c++层 的源码
+ └─tools 服务器相关脚本

## tools/db目录下脚本说明
tools脚本说明：

[thoughts 文档](https://thoughts.teambition.com/workspaces/5df8bf6497d77a00134e3c27/docs/5e0ff7f6f0bbb70001ff340b)

db脚本说明：

backupdb.sh ： 保存数据库

importdb.sh ： 导入数据库

install.sh ： 安装数据库到本地

update.sh：更新数据库文件

游戏数据库构建的方式：

config目录下的SQL文件为服务器配置，database目录下为游戏内容数据基础，version目录下面是数据库版本更新文件，名字必须是增量，代表数据库更新的版本。

## 运行环境（vagrant+virtualbox）
virtualbox： 为游戏提供运行所需系统

vagrant： 相当于配置一个系统，通过VagrantFile完成游戏服务器一些相关依赖的安装和配置。 具体配置方式参考：

[https://www.vagrantup.com/docs/vagrantfile](https://www.vagrantup.com/docs/vagrantfile)

[thoughts 文档](https://thoughts.teambition.com/workspaces/5df8bf6497d77a00134e3c27/docs/5e95630845db20000171f87b)

## 开发调试（游戏内GM，善用重载，保证安全）
### 开发环境提供内部GM系统：
![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656056660-55e3c448-f400-4cce-8d96-cae026778801.png)

我们在聊天系统内部构建了一套GM系统，在开发环境下以头部特殊字符区别该代码执行在哪里：

+ ! ： 代表此代码需要执行在客户端
+ @： 代表需要执行当前玩家所在的场景服务器（scene）
+ @@ : 代表此代码需要执行在所有场景服务器（scene）
+ # ： 代表代码需要执行在会话服务器（session）
+ $ ： 代表执行在跨服服务器（cross）
+ $$ : 代表所有跨服

等等。。。具体其他服务器相关指令参考游戏内的 GmCmd_C.lua文件

### 开发建议
在开发一·个新的功能前，提供一个DoScript.lua 脚本

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656057089-515ff1d2-db84-4349-8a54-c42542f3f4f6.png)

类似上图DoScript函数将所有文件重新加载。在GM命令区域提供重载按钮，重新载入脚本即可，加快调试速度，提高开发效率。

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656057536-e8ed760b-3d09-47eb-8886-2820460f1b97.png)

