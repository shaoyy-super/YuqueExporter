以fa(魔龙世界)全局商店为例讲解一下全局功能开发流程

[<u>数据存储</u>](https://thoughts.teambition.com/workspaces/5ef1a751f60ea9001bd606cc/docs/5f2a5855e6eed500012bc219)~~(~~全局数据存储可以参考**3.全局数据存取** )

数据库存储文件:projectfa\server\src\pb\miscvar.shop.global.proto

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656001123-06901cc2-1eaf-460f-bcca-ed6af5f0daab.png)

数据序列化反序列化逻辑:projectfa\client\Assets\LuaFramework\Script\Global\MiscVars\GlobalMiscVarShop_GC.lua

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656001742-66bc6acb-9bf4-4825-a3e2-e9b718d6cdde.png)![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656002172-c1bf91e0-124c-44d1-98d8-89fed209e1f0.png)![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656002587-abaa7b40-14ce-402e-a657-7cebd4005d6d.png)![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656002908-1929a24b-dd11-4607-b7b2-7e899e6941a9.png)

注册

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656003294-e952b2fd-dfa0-4281-9822-bc41256d3160.png)

添加存储文件枚举:projectfa\client\Assets\LuaFramework\Script\Global\GlobalMiscVarDef.lua

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656003678-d41b9cda-d36b-4a4c-9881-6f896adaf721.png)

**全局功能的主要逻辑开发在session服务器(**[**<u>一组服务器唯一</u>**](https://thoughts.teambition.com/workspaces/5ef1a751f60ea9001bd606cc/docs/5f2a5838e6eed500012bc189)**)上,为了保持数据的唯一性已执行, 分布在多个scene的玩家通过协议访问session**

全服商店主要逻辑:projectfa\client\Assets\LuaFramework\Script\Shop\Shop_GC.lua

![](https://cdn.nlark.com/yuque/0/2024/png/43288467/1712656003989-6596073e-4bbe-42f4-baf5-76fce3f6a4fc.png)

