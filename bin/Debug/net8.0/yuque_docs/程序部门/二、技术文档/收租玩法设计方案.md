# 一、简介
内容：玩家移动到地产格，如果该格子上随机了租客，则会根据地产格上面存在的绿房子或红房子数量，针对租客进行一定的租金收取



# 二、结构设计
内容：

:::info
红房子，绿房子

1. 玩家每次升级建筑后，都会在地产格上随机一个绿房子
2. 同一个地产格上的绿房子数量达到一定数量会合成一个红房子
3. 每一个地产格上只能有一个红房子
4. 地产格会分为多组，每组地产格上都是红房子后，如果随机到的绿房子落在改组地产格上，则会拆除该组地产格上所有的红房子，拆除的红房子会转化成经验道具返还给玩家，拆除后，可继续放置绿房子

收租

1. 玩家移动到地产格后，如果上面有租客，并且有地产房，则会执行收租逻辑，如果没有地产房，直接更新收租事件状态，重新随机下一个租客
2. 玩家升级后，可能会增加租客数量的特权，如果总租客数量增加，会随机新的租客

:::



# 三、详细结构设计
内容：

:::info
1. Monopoly:TryRandTenant(player) 玩家登录后调用此接口，检查是否需要随机新的租客
2. Monopoly:OnVerifyTenantFriend_GS(player_id, target_id, exclude_ids) 检验好友是否达到成为租客的条件
3. Monopoly:OnRefreshTenant_GS(player_id, target_id, exclude_ids) 刷新租客
4. Monopoly:OnRefreshTenantResult_GS(player_id, rand_player_id) 刷新租客最终结果
5. Monopoly:OnPlayerBeCollectRent_GS(player_id, target_id, items) 租客被收租租金，通知被收租玩家，更新被收租玩家相关数据
6. Monopoly:PlayerCollectRent(player) 收租接口，先检查可不可以收租，如果达到收租条件，获得相应的道具奖励，并通知被收租玩家更新数据
7. Monopoly:RandTenantPosition(player, target_player_id) 刷新的租客，通过此接口随机一个地产房放置
8. Monopoly:TryAddNewTenant(player) 玩家升级后，检查是否有新增租客

:::



# 四、流程设计
![](https://cdn.nlark.com/yuque/0/2024/png/44713460/1721640267056-4f10b6ac-4300-4cfd-9e3e-1fd22d8e876e.png)



# 五、提出问题
无



---

# 六、总结整理（开发完成后撰写）
开发过程中，很可能产生跟上面方案不一致的地方。可能补充了更多的细节内容，可能由于某些未想到的原因推翻了方案中的一些设定。

所有开发完成后有价值的内容，都可以记录在这里。

