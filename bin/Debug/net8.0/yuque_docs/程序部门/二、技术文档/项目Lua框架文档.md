（请在push第一份代码前阅读此文档）



本文档不涉及任何代码中的问题，仅对框架进行说明。

对于常见问题的解释：

1. 为什么要使用lua作为主要开发语言。

我们知道C#工程需要编译才能形成最终的程序，在当今移动游戏当道的时代，对于热更新几乎会在游戏方方面面得到体现，除了一些基本的工具以外，游戏的各个部分都有这样的需求。如果需要重新编辑再发布，让用户重新安装游戏，会损失一大把用户，每一次都是如此。本着不让用户重新安装软件就能实现更新的效果，我们需要一种能够直接插入和删除代码而不需要重新编译的语言，或者可以说：需要一门解释型语言。而lua作为一门轻量级解释型语言，拥有高度自由的语法，再加上来自腾讯的XLua插件能将Lua和C#代码紧密联系起来，让原本在移动互联网时代快要死去的C#焕发了最后一次青春。

2. C#和Lua是如何链接在一起的

这个问题对于不同的项目有不同的答案。在丝芭传媒游戏开发部，我们采用了XLua作为中间工具，并对其中的一些部分进行了进一步的运用。

进行unity开发的同学们都知道，每一个游戏都是很多个场景组成，场景中有各个GameObject，各个GameObject中有众多种类组件，针对UI和一些非3D的部分，我们写了一个名为Component4Lua的脚本（简称C4L）脚本中提供了一些通用接口，例如用于操作RectTransform的，操作UI基类的等。在Lua中，这些东西是表c4l下的一些方法，可以直接调用。当然需要先对它进行初始化。

![](https://cdn.nlark.com/yuque/0/2024/png/44684279/1719388058882-6e20b870-4cc6-481b-9bd5-cca5c4aec35e.png)

Component4Lua还提供将组件拖入列表传入Lua的功能，它本身也需要被挂载在各个panel的GameObject中。具体使用方法会在后续对于各个Lua类的解释中详细向大家展示，这里就不多赘述。

上述只是其中一部分链接的方法，并非所有，具体情况请更深一步的对本文档和本文档下属的子文档就行阅读。

3. 代码存放的位置

以山海项目为例以下是一些关键文件的位置

UI_Town_Ctrl.lua（主界面控制器）: Client\ExtAssets\Lua\Presentation\CSys\Town\UI_Town_Ctrl.lua

上面的路径中可以看出，主要用于表现的代码都被放在Presentation下，而其中的CSys则放置常用的UI界面控制代码

Main_C.lua（游戏入口）：Client\ExtAssets\Lua\Presentation\Main\Main_C.lua

了解了上述的例子以后，可以熟悉一下项目的结构



lua项目被放置在Client\ExtAsset中

![](https://cdn.nlark.com/yuque/0/2024/png/44684279/1719388525360-f090f4ef-88d1-4128-bed5-60c15798ebe6.png)



ExtAsset下有以下5个文件夹

![](https://cdn.nlark.com/yuque/0/2024/png/44684279/1719388809504-d8fc6ad7-f6b9-4624-9d65-ec30b906831a.png)



其中Config\normal下有从excel中使用宏配置的json文件

![](https://cdn.nlark.com/yuque/0/2024/png/44684279/1719389042698-e6984d04-a155-4cd8-864b-343a6327bf2b.png)



在Presentation下存在7个文件夹，我们开发主要是在Core，CSys，Global和Main下进行

![](https://cdn.nlark.com/yuque/0/2024/png/44684279/1719389658195-0d065c5a-bf80-4042-a24c-234560d05027.png)

以上就是关于系统的层级结构简单的解释，剩下部分请参考本文档下的其他文档的说明





