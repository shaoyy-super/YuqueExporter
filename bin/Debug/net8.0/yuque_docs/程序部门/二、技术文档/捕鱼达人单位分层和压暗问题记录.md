

多个boss同时出现，各个阶段鱼要分不同的层级（高度），同时每个阶段都可能有压暗表现  


[Boss鱼出生、死亡表演层级规则](https://snh48group.yuque.com/ttk5k0/manpny/kgcvined3qetvhoc)



为了非运行时和运行时逻辑一致，有以下几个问题需要处理



## 1、建立Timeline与动态生成单位的关联关系
非运行时，只允许按照标准流程操作，在这个时候建立关联

只要有代码编译，就清空所有的单位，再点击生成按钮，建立新的关联关系

运行时和非运行时逻辑有区分



### 2、根据TML区分属于哪个阶段
记录出场、移动、死亡tml，不同的tml、不同压暗效果处于不同的高度



### 3、非运行时要支持压扁和压暗
压扁脚本，添加开关，用来控制是否执行压扁逻辑



### 4、Timeline动态创建的单位或特效，结束需要有个事件
在结束的时候，设置动态单位的高度或其他压扁参数

<font style="color:#DF2A3F;">需要TML Package功能支持</font>



### 5、TML运行环境设置
非运行时也要设置项目自定义的TML环境，并且在代码编译时重新设置



### 6、配置一个不同层级区间数据
从出生到死亡各个阶段的层级区间数据



### 7、Timeline目标设置
owner是渔场内的单位

target是场景全局的适配单位

Boss相关的timeline要过一遍，保证按照这个规则来控制特效或动态单位的生成



### 8、常态压暗TML
做法和出场和死亡tml一致，需要常态压暗，就做一个游走的tml，添加压暗轨道，这个压暗类型是常态压暗  
(现有做法是**做一个通用的常态压暗循环tml**，永远只播放一个，但是得代码管理计数，来控制tml播放和暂停)



**最后基于以上改动，修改部分逻辑，以及测试效果**

