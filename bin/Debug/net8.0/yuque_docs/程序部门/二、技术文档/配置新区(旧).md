### 添加新服配置
+ 添加新服的pillar信息ps

# 备份pillar文件cp jz.sls  jz.sls.bak# 添加新服配置到zones下vim jz.sls   61: 

      name: "激战61区"

      ip: 115.159.115.131

      host: "dm-1"

      id: "04"

    62:

      name: "激战62区"

      ip: 115.159.22.96

      host: "dm-2"

      id: "04"

    63:

      name: "激战63区"

      ip: 122.152.221.191

      host: "dm-3"

      id: "04"

+ 刷新pillar

salt '*' saltutil.refresh_pillar

+ 查看pillar

salt '*' pillar.items

+ 检查pillar

# 执行脚本，文件详见附件bash check_pillar.sh my.sls     如无输出，表示文件无误

### 创建游戏区服
+ 执行创建新服命令

# 确保pillar已经刷新到minion节点上，否则，会将线上区服删档salt '*' state.apply game.create pillar='{"zone": "*"}'# 安装游戏版本salt '*' state.apply game.install pillar='{"zone": "*", "version": "3.4.123.85323", "env": "zones"}' # 开启备份定时任务salt '*' state.apply game.start-backupdb pillar='{"zone": "*"}' 

### 整合pillar
+ 将配置的新服信息添加到原pillar文件的zones_wait下，并刷新查看pillar

salt '*' saltutil.refresh_pillarsalt '*' pillar.items

### 修改游戏列表
+ 在目录服上，添加新的区服信息到/data/ProjectDM/group/server_list.json

vim server_list.json{

            "id": 600,

            "name": "数码600区",

            "state": 5,

            "urls_login": [

                "host-12.smbl.zs-e.com:10020"

            ],

            "urls_game": [

                "host-12.smbl.zs-e.com:9020",

                "host-12.smbl.zs-e.com:9021",

                "host-12.smbl.zs-e.com:9022",

                "host-12.smbl.zs-e.com:9023"

            ]

        },

### CheckList检查事项
| 检查salt的pillar文件（有无重复的配置） |
| :--- |
| 检查游戏配置版本（main，main_ios） |
| 检查游戏版本 |
| 检查配置的server_list.json文件 |
| 检查数据库备份定时任务 |


[check_pillar.sh](https://tcs.teambition.net/storage/101r87dd5d9f2d93bde1131967f85ee37811?Signature=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJBcHBJRCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9hcHBJZCI6IjU5Mzc3MGZmODM5NjMyMDAyZTAzNThmMSIsIl9vcmdhbml6YXRpb25JZCI6IiIsImV4cCI6MTcxMzc4MTMxMiwiaWF0IjoxNzEzMTc2NTEyLCJyZXNvdXJjZSI6Ii9zdG9yYWdlLzEwMXI4N2RkNWQ5ZjJkOTNiZGUxMTMxOTY3Zjg1ZWUzNzgxMSJ9.4XNUQ6YfsD6xr87d-qt0HX_WBreVkBV1Ocl5K2-u3ns&download=check_pillar.sh)

