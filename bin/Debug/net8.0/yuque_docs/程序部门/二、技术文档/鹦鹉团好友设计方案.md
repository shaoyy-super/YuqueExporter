# 一、简介
好友为游戏基础功能，包括下面几个要点

### 加好友规则
+ <font style="color:#000000;">.添加好友为双向操作，一方发出好友申请后需要对方同意后，双方才能成为好友：</font>

### <font style="color:#000000;">删除好友</font>规则
+ <font style="color:#000000;">删除好友为单向操作。点击删除好友按钮将出现确认弹窗：是否确认删除好友？点击确定按钮解除与对方的好友关系，点击取消按钮弹窗关闭。</font>
+ <font style="color:#000000;">A删除B的好友后，B将从A的“我的好友”列表内删除；同时A将自动从B的“我的好友”列表中被删除。</font>

### <font style="color:#000000;">好友交互</font>
+ 成为好友后，玩家可以在好友列表内为好友赠送金币

### 系统推荐
+ 玩家可以在好友功能界面中的“系统推荐“页签内查看系统推荐的玩家列表，从中选择自己感兴趣的玩家进行关注

### 我的玩伴
+ 包括以下情况的玩家将会被加入到玩伴列表中
    - 私聊过对方，或者对方私聊过我；
    - 等待室内做过互动动作；
    - 等待室内一起跳过舞（包括局内旁边的人）；
    - 急速匹配一起组队跳舞过的玩家；
    - 我邀请进等待室的玩家，或者邀请我进等待室的玩家；

### 黑名单
+ 屏蔽和取消屏蔽均为单向操作，无需对方同意；
+ 点击屏蔽按钮将出现确认弹窗：是否将对方加入黑名单？点击确定可以将对方加入黑名单，点击取消弹窗关闭。

### <font style="color:#000000;">好感度</font>
+ 好友界面“我的好友”、“好友申请”列表中显示好感度等级和进度
+ 好友之间可以通过每日赠送金币、一起游戏等行为提高好感度。

### <font style="color:#000000;">好友界面示意图如下</font>
![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1733390355679-184ce650-14c8-41da-9ed6-b0858c8f7ae4.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1733390377402-a1981e75-b434-475f-95d9-ed87a4b5c7fa.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1733390414140-16e8d1a8-fb7f-498e-9279-c27ce8507cca.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1733390434561-14a8f32e-ea01-474f-a222-86caf55057a4.png)



# 二、结构设计
内容：

:::tips
1. 新增流程控制脚本
    1. Page_Friend_Ctrl.lua，负责好友的流程控制
2. 新增VM脚本
    1. FriendVM.lua，负责好友的数据管理和网络通信
3. 新增UI脚本
    1. UI_Friend_Ctrl和UI_Friend_Panel：好友主界面
    2. FriendData：好友数据单元
    3. UI_FriendItem： 好友列表显示单元
4. 使用的通用功能及组件
    1. 使用 UIMgr:Open(UIEnum.MoneyMenu)  显示顶部通用菜单
    2. 使用RoleMgr.lua根据id、role_type获取玩家信息
    3. 使用DressActor.lua显示玩家模型
    4. 使用RedMark.lua显示红点
5. 资源管理
    1. 在UI_Friend_Ctrl的好友选择时加载模型，两种性别对应两个actor，退出好友后调用actor:Release()删除模型，清除对象。
    2. 好友默认场景Sce_Friend。

:::

# 三、详细结构设计
内容：



:::info
1. 好友数据来源
    1. 我的好友、我的玩伴、黑名单：RLSGetFriendListReq
    2. 系统推荐：RLSGetSystemRecommendPlayerReq
    3. 好友申请：RLSGetAskAddFriendListReq
2. 排序策略
    1. 默认排序：<font style="color:#000000;">在线 -> 好感度 ->离线时间（即在线的好友在前，离线好友在后；在线与离线的好友按好感度从高到低排序；好感度相同的好友离线时间最近的在前）</font>
    2. 亲密度排序：按照亲密度降序排序
3. 好友场景预设

![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1733386803242-c2cdc15d-5984-4aa8-83c8-d57997228fea.png)

RoleNode设置模型加载位置，缩放和旋转

VCM虚拟相机设置相机远近和位置

4. 类的依赖关系及重要方法  
 

:::

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/44314719/1733389114089-6b3d829c-d0aa-46de-bd39-7d0fdd19f200.jpeg)



# 四、流程设计




# 五、提出问题
如果存在重点、难点问题的解决方案没想清楚，可提出问题在会上讨论



---

# 六、总结整理（开发完成后撰写）
开发过程中，很可能产生跟上面方案不一致的地方。可能补充了更多的细节内容，可能由于某些未想到的原因推翻了方案中的一些设定。

所有开发完成后有价值的内容，都可以记录在这里。

