# 一、简介
聊天系统根据不同的类型消息分为不同的频道，支持表情、语音、文字、链接等，同时对玩家的消息长度、发言频率、语音时长等作相应限制



![](https://cdn.nlark.com/yuque/0/2024/png/48074702/1732871251107-97092c89-4d70-4131-850f-b66d3b56a359.png)

![](https://cdn.nlark.com/yuque/0/2024/png/48074702/1732871275549-c9b0ad3d-a83e-47c7-b336-0e7217dafa44.png)

主页消息![](https://cdn.nlark.com/yuque/0/2024/png/48074702/1733208773092-31420fd8-1745-45cf-bdb4-b265cbbca046.png)

等待室消息

![](https://cdn.nlark.com/yuque/0/2024/png/48074702/1733208801290-ec3ecf96-ad45-4c2d-a04b-3e8e1df7d645.png)![](https://cdn.nlark.com/yuque/0/2024/png/48074702/1733208832526-74def4e6-50ba-435b-b80f-967624d9e313.png)

# 二、结构设计
内容：

:::tips
1. Page部分
    1. Page_GameMain_Ctrl 聊天记录的加载
2. UI部分
    1. UI_ChatMain_Ctrl、UI_ChatMain_Panel聊天主UI，控制频道切换，置顶消息、消息表情等发送
    2. UI_Chat_System_Ctrl、UI_Chat_System_Panel 系统频道消息处理
    3. UI_Chat_Current_Ctrl、UI_Chat_Current_Panel 当前频道消息处理
    4. UI_Chat_Private_Ctrl、UI_Chat_Private_Panel 私聊频道消息处理
    5. UI_Chat_Horn_Ctrl、UI_Chat_Horn_Panel 喇叭频道消息处理
    6. UI_Chat_Region_Ctrl、UI_Chat_Region_Panel 地区频道消息处理
    7. UI_Chat_GameMain_Ctrl、UI_Chat_GameMain_Panel 游戏大厅消息处理
    8. UI_Chat_WaitingRoom_Ctrl、UI_Chat_WaitingRoom_Panel 等待室消息处理
3. VM
    1. ChatVM 聊天相关通信、数据缓存
4. 其他
    1. Chat_Sdk 获取定位、聊天语音、录音等接口
    2. Chat_Storage 聊天记录存储读取
    3. Chat_Rule 聊天规则（禁言、间隔、长度等）
5. 通用功能、组件
    1. 扩展GL_TextLink处理链接
    2. DataStorage 数据存取
6. 资源管理
    1. Page_GameMain_Ctrl 中加载本地聊天记录

:::

目的：先对自己的功能大结构上的规划，才能指导后面逐步做更详细的设计



# 三、详细结构设计


内容：

:::info
1. 通用的模块：用UML类图给出全部对外接口的定义（要带参数）；如果涉及多个类或者脚本，要在类图中体现出依赖关系
2. 系统内重要的模块：用UML类图或XMind脑图给出重要数据结构定义，并且体现出模块间的依赖关系
3. 除类图、类结构的详细说明外，还应该给出功能涉及到的各种重要规则、用法的说明。

:::

目的：

:::info
1. 对重要的部分，深入思考实现细节。
2. 列出依赖关系，辅助思考设计是否合理。
3. 让其他人更直观的看到具体用法（主要是指通用的部分）

:::

注意点：

:::info
1. 通用模块，自身功能实现要完备（如：有开就要有关）。不要为了偷懒随意搞全局的东西出来
2. 通用模块，对外提供的接口要简洁易用
3. 标记依赖关系的时候，重点思考内聚、耦合问题

:::



# 四、流程设计
内容：用时序图描述模块间的交互流程；用流程图描述核心算法

目的：讲解流程。通过画图让自己思考更深入、让其他人看的更直观。





![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/48074702/1732851594214-313c661f-26ff-487c-9147-acf6ca057f63.jpeg)



![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/48074702/1732872246546-8b3386a4-ecb8-4945-ad4a-6fede97360f7.jpeg)

# 五、提出问题
如果存在重点、难点问题的解决方案没想清楚，可提出问题在会上讨论



---

# 六、总结整理（开发完成后撰写）
开发过程中，很可能产生跟上面方案不一致的地方。可能补充了更多的细节内容，可能由于某些未想到的原因推翻了方案中的一些设定。

所有开发完成后有价值的内容，都可以记录在这里。

