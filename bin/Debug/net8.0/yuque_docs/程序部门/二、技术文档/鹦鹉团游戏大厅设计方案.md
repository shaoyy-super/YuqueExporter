# 一.简介
+ 玩家在游戏大厅内可以自己创建房间，或加入他人创建的房间
+ 从游戏大厅进入等待房间后，玩家将进入等待游戏状态，房间内所有成员准备就绪后，将进入游戏对局

示意图如下：

![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1724402467955-54e093e6-0010-4ee9-9566-2cc38010928e.png)



![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1724402489345-a3d52e30-879a-47c0-b965-2d6fde04c771.png)



![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1724402518889-fcf47743-8d2b-4f32-8554-a18e208dcff9.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1724402537878-9b73bb82-3197-4f29-b547-c401e6be7dfd.png)



![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1724402552242-d0482a2e-a49c-498b-a3d2-9514d4791ff3.png)

# 二.结构设计
**1.新增界面相关脚本：**

        * 游戏大厅模块资源管理和跳转： 
        * **Page_Hall_Ctrl.lua**
        * 游戏大厅主界面： 
        * **UI_Hall_Ctrl.lua，UI_Hall_Panel.lua和UI_HallRoomItem.lua（房间显示单元）**
        * 创建房间界面： 
        * **UI_CreateRoom_Ctrl.lua和UI_CreateRoom_Panel.lua**
        * 玩法筛选界面： 
        * **UI_PlayTypeFilter_Ctrl.lua和UI_PlayTypeFilter_Panel.lua**

**2.新增通用数字键盘脚本：**

        * **UI_NumberPad_Ctrl.lua和UI_NumberPad_Panel.lua**

**3.新增VM相关脚本：**

        * **WaitingRoomVM.lua**，用于存储房间数据，发送和接收服务器协议数据,，包括获取房间列表（MASGetRoomListReq），刷新房间列表（MASGetRoomListInfoReq），搜索房间（MASGetRoomInfoByRoomIDReq），加入房间（MASJoinRoomReq），创建房间（MASCreateRoomReq）

       **4.新增数据枚举类型脚本:**

        * **WaitingRoomDefine.lua**，定义GameMeans（游戏中，旁观），PlayerRoomState（玩家状态）JoinMeans（进入房间来源）,RoomType（房间类型）

# 三.详细结构设计
**1.房间单元数据结构**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/44314719/1724403855516-0637a793-1cbb-4efc-80c9-17e17604ab6a.jpeg)

**2.类的依赖关系及重要方法。**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/44314719/1724410366205-371bc10c-8d73-47fc-abbd-f71e3e31a688.jpeg)

**3.场景预设**



![](https://cdn.nlark.com/yuque/0/2024/png/44314719/1724411026814-f36906b5-8c1d-4db6-8973-e8e88699b916.png)

使用HallPreset预制体VCM，调节场景相机旋转和坐标

使用HallPreset预制体RoleNode，通过该节点设置角色初始坐标，旋转和大小

使用HallPreset预制体WorldUIRoot节点作为3DUI挂点，通过该节点设置UI坐标，旋转和大小，或者调节3DUI预制体本身大小，3DUI预制体本身不调整位置和旋转



# 四.流程设计


**1.游戏大厅房间列表刷新流程**



![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/44314719/1724339832115-9bc28b0e-f7b3-4ccd-acf4-b0db696a1c9f.jpeg)

**2.搜索房间流程**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/44314719/1724328565379-a4b659ae-019b-4154-aff8-05c35ef06719.jpeg)



# 五.问题
部分功能如锁定位置，需要等等待室开发完可以测试



## 
  
 

