# 一.简介
通过提供可视化的工具和界面，让能帮助音乐制作人、音乐爱好者等用户够直观地设计和调整MV玩法的镜头部分，使其更加高效、便捷地创建和编辑游戏MV效果。

![](https://cdn.nlark.com/yuque/0/2024/png/44683805/1733313637905-751db91f-ff98-43cb-807e-9299ef9720e7.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_1687%2Climit_0)

# 二.结构设计
拓展编辑器框架，以下脚本为新增的扩展脚本，编辑器基础功能请转至[https://snh48group.yuque.com/lw0nsy/zeet2g/feszuvkh7uuhqaff](https://snh48group.yuque.com/lw0nsy/zeet2g/feszuvkh7uuhqaff)

**脚本概述**

1.**数据管理**

+ CameraModuleData：ModuleDataBase，镜头模组数据
+ CameraClipData：ClipDataBase，镜头片段数据

**2.界面管理**

+ WindowMgr界面总管理器脚本，管理所有界面，管理数据初始化，界面初始化/释放等等，以及用于编辑器的Tick。
+ ActionWindowMg:WindowMgr 行为界面总管理器脚本，主要包含动作和镜头相关的纵截面
+ ItemBase：组件基类



+ CameaModuleItem：ItemBase，相机按键组件。



+ ClipItemBase：ItemBase，clip组件基类
+ CameraClipItem：ClipItemBase，相机轨道片段组件。

**3.相机逻辑功能**

+ CameraResMgr.lua 相机资源片段管理器
+ CameraDataVM.lua 相机数据管理器，读取/搜索本次跳舞所需要的所有相机数据
+ CameraPlayCtrl.lua 相机播放逻辑管理器，处理相机播放逻辑

# 三.详细结构设计
**1.相机模组的数据结构**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/46026893/1734056990516-eaac0902-6338-4636-9697-8c253ad11c01.jpeg)

**2.相机片段的数据结构**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/46026893/1734060455834-a4dd8ae8-7b1d-490e-bdb3-356485fbf858.jpeg)

**3.相机模组的表格配置**

![相机分类的大页签](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734057900532-f83803e9-9129-44e6-8c01-f333eb193b8d.png)



子页签归类按照ID来划分，首位1归类为：静态镜头。

![相机分类的子页签](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734057922503-c83c94cb-5e13-47c4-9672-fb476eed6e39.png)



相机模组的具体归类按照ID来区分，前三位101归类为：静态镜头-近景镜头。

![相机模组内容](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734057993187-6a788b07-d88c-48c7-819f-e668ad17d846.png)

**4.导出的相机编辑器片段数据结构**

![](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734058363475-bfdbb2ec-ef49-495f-a4cf-eaa88dd94b8c.png)

**5.跳舞镜头播放逻辑**

+ 根据作品数据获取镜头配置信息。
+ 获取相机的生命周期![](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734067182085-70ec65c2-2aba-423d-918e-2dd9fbcaf538.png)
+ 解析作品配置信息![](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734066876463-93746c79-3382-4b82-bf1f-107558446caf.png)![](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734067058386-bac64014-e11b-41a3-9981-41e37aab7aad.png)，获取初始值和结束值。
+ 使用lerp差值函数，在相机生命周期中，每帧更新相机的位置/角度/Fov等信息。

**6.游戏内相机结构体**

**    **根据相机规则，修改相机控制的预制体。

![](https://cdn.nlark.com/yuque/0/2024/png/46026893/1734057613168-31a59474-1939-488e-9dc1-eec8cf4329aa.png)

+ CameraGo用来播放相机动画
+ Pos处理相机的x，y偏移
+ Rot处理相机的角度旋转

**6.类的依赖关系及重要方法。**

![画板](https://cdn.nlark.com/yuque/0/2024/jpeg/46026893/1734068448889-b96690c7-6c1e-4736-b223-6820851e805c.jpeg)

 

# 四.流程设计
# 五.问题
