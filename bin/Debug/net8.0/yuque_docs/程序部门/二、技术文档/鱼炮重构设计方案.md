# 一、简介
内容：目前鱼泡的代码都在GunAttr.cs类中，需要将csharp脚本替换为lua现实，同时用ECS重构

目的：代码结构清晰合理，方便热更



# 二、结构设计
内容：

:::tips
1. GunSystem.lua 负责处理玩家之前的开火逻辑，以及炮台的加载合销毁
2. GunComponent.lua 存放炮台相关的配置，数据等
3. 删除PlayerInfo.cs 这个是原先的中间类
4. 删除GunAttr.cs 这个是原先玩家炮台相关的实现

:::





# 三、详细结构设计
内容：详细拆解了上述上个类中的内容，具体细节实现的时候或有差异，但是整体思路不变

:::info
1. 通用的模块：用UML类图给出全部对外接口的定义（要带参数）；如果涉及多个类或者脚本，要在类图中体现出依赖关系
2. 系统内重要的模块：用UML类图或XMind脑图给出重要数据结构定义，并且体现出模块间的依赖关系
3. 除类图、类结构的详细说明外，还应该给出功能涉及到的各种重要规则、用法的说明。

:::

目的：详细拆分GunAttr.cs的代码，使其适应新的架构

:::info
1. 对重要的部分，深入思考实现细节。
2. 列出依赖关系，辅助思考设计是否合理。
3. 让其他人更直观的看到具体用法（主要是指通用的部分）

:::

注意点：GunAttr.cs 存在较多的细节代码，还有大段的冗余逻辑，注意道具使用的相关字段的合并

:::info
1. 通用模块，自身功能实现要完备（如：有开就要有关）。不要为了偷懒随意搞全局的东西出来
2. 通用模块，对外提供的接口要简洁易用
3. 标记依赖关系的时候，重点思考内聚、耦合问题

:::



UML 类图

![](https://cdn.nlark.com/yuque/0/2024/png/49784329/1733742461348-312a51e9-6bf6-45b2-a89b-da0759ef2c69.png)





# 四、流程设计
内容：用时序图描述模块间的交互流程；用流程图描述核心算法

目的：讲解流程。通过画图让自己思考更深入、让其他人看的更直观。



时序图

这个和原始的流程一样，不修改，不赘述

流程图

这个和原始的流程一样，不修改，不赘述



# 五、提出问题
如果存在重点、难点问题的解决方案没想清楚，可提出问题在会上讨论



---

# 六、总结整理（开发完成后撰写）
开发过程中，很可能产生跟上面方案不一致的地方。可能补充了更多的细节内容，可能由于某些未想到的原因推翻了方案中的一些设定。

所有开发完成后有价值的内容，都可以记录在这里。

