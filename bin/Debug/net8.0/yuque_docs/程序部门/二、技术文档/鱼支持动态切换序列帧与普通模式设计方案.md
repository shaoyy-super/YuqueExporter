# 一、简介


渔场内单位比较多，特别是小鱼，大量的Animator对CPU有一定的性能消耗，通过使用序列帧动画，减少这块的消耗，同时美术表现不会有太大的偏差



还有一些单位，根据设备的高中低配置，使用不同的加载模式，牺牲一些美术表现，来降低Animator性能消耗



# 二、结构设计


## 1、单位加载模式
+ 只有序列帧：部分动作很简单的小鱼
+ 只有普通模型：所有Boss、部分精英鱼、小鱼
+ 序列帧 + 普通模式：部分精英鱼、小鱼



UnityActorCtrl脚本，需要有个标记，当前使用的哪种模式，C#和Lua逻辑可能需要关心这个状态

Lua对应的LoadComponet需要记录创建鱼的模式

## 2、UnitLoad表改动


+ 添加一个字段 sequence_prefab，如果有序列帧动画，配置对应的预制体名字，没有就配0
+ 原有的prefab仅表示普通模型对应的prefab，没有就配0



同一个单位，如果有两种模式，需要再添加一个load_id，分不同的load_id，方便单位加载管理

![](https://cdn.nlark.com/yuque/0/2025/png/22817384/1736326000670-cb4c620f-db27-45a3-bf68-6768b57e26c0.png)



## 3、FishType表改动


+ unit_load_id 原来对应的一个load_id，改成数组，如果长度大于1，默认第一个是普通模式load_id，第二个是序列帧动画的load_id
+ hit_tml和die_effect_tml 同上，改成数组，因为不同模式对应的tml轨道不通用，需要配两个



## 4、单位加载


+ 如果unit_load_id只有一个load_id，那就根据load_id加载即可
+ 如果unit_load_id支持两种模式，根据高中低配，选择对应的模式加载



之前使用unit_load_id的地方，要修改下接口，传入加载模式

**然后还有一些资源管理，需要特殊处理下，这个待讨论**

****

**5、序列帧动画单位目录划分！！！**

****

+ 需要和正常单位目录分开
+ 具体找动作确认下，他们哪种划分方式比较习惯



# 三、提出问题


## 1、不同的鱼，有需求针对不同的高中低配，选择不同的模式吗？
比如中，精英鱼用模型，小鱼用序列帧

低，都用序列帧



后续有需求，再处理，比较方便

## 2、有的精英鱼是动画轨迹，这种单位能支持序列帧动画吗？


看美术需求，能接受效果就做，程序这边逻辑暂时不需要改动





---

# 四、总结整理


