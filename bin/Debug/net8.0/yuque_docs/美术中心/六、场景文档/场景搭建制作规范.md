# 光照设置
## 主光源
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669275382-bfa58126-8300-49ba-a3bf-6812c86aa8ce.png)

### 1.主光源只能使用平行光或者聚光灯，不能使用点光源
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669294535-b7ff3b52-574a-4e77-a1e6-da490fb2dfcb.png)

### 2.主光源的缩放值需要保持默认，不能对光源进行缩放操作
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669300628-6f7de6b9-c427-4a70-b8b0-8f05072ae6d7.png)

### 3.照亮层级需剔除除场景以外的其他所有层级
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669316803-b255a316-4bbb-4012-8a6e-08ce907efa96.png)

### 4.主光源需要在低配光源层级中
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669332052-97e40f75-7ef2-40b3-b751-6353bdac00b3.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669337291-6083a3ed-f48c-4884-9b74-10f5023b2ae2.png)

### 5.主光源模式要设置成mixed
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669351621-a367b7ad-7e7e-4403-85e9-d3d6aa593140.png)



## 动态光
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669368667-22bf5af7-0ec7-4e99-bbec-f74ac82cbb0b.png)

### 1.动态光照亮层级也需剔除除场景以外的其他所有层级
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669382923-520996c4-5f39-4ef0-a5cc-963677fd9437.png)

### 2.除主光源外，其他动态光不要产生投影
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669398544-d4be4fc1-8a08-45d8-ab9a-c6b857cb4426.png)

### 3.动态光需要根据重要程度对灯光进行分级适配
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669411581-07e9e274-5d6c-43fe-a0b8-427cc77abbf3.png)

最低配层级尽量只保留主光源，中配层级（包含低配）可以保留五盏以内动态光，高配层级（包含低配与中配）可以保留十盏以内动态光



## 烘培光
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669447358-53126146-2301-480a-83a7-d9aa16ab39e5.png)

### 1.烘培光需要将灯光改为baked模式
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669461333-4052b833-586d-493b-bc6f-204d84475011.png)



## 反射
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669477977-3b657ac0-8498-4b3c-8202-c56da5b8eb56.png)

### 1.场景必须设置反射，可以是baked或Custom模式
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669495513-89f43d3b-3b24-46bf-aa61-6d95596e359c.png)

custom模式一般一个场景使用一个反射球，将需要用到的cubemap放入对应的槽中

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669512744-2a1fc5e4-360e-4626-98e1-2ab031efd24f.png)

baked模式可以根据区域添加反射探头的数量，数量越多越准确，但是战斗场景不要超过7个，因为烘焙反射贴图也需要占用内存

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669526954-2d713a6c-8ff7-4645-b2fb-e0e70e4f8672.png)

### 2.反射球亮度等参数保持默认，不要做调整
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669541593-e6344c98-9ebd-49b8-a5c4-82bb1b28c2a6.png)

### 3.反射捕获范围根据场景大小做调整
custom模式下，反射球将场景完全包裹住

Baked模式下，根据自己的需要，调整每个反射球的影响范围

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669557775-89d78875-4792-4409-a4b0-cebec27e14b7.png)

# 脚本设置
## 场景脚本（LightSettingVolume）
**场景中必须添加****lightsettingvolume****脚本**

在场景中创建Create Empty，改名为lightsettingvolume

点击add component，添加lightsettingvolume

LightSettingVolume的layer层级要设置为PostProcess_01

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669580873-f8722a32-8b88-4798-bc0c-edc052bac626.png)

### 1.雾效控制（必开）
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669598931-aad84230-0121-4710-b666-0c2971193250.png)

**每个选项的作用**

Fog Density：雾效的整体密度

Fog Opacity：雾效由上到下的不透明度渐变

Fog Hight：雾效上升高度

Hight Fall Off：雾效下沉高度

Fog Top Color：上层雾效颜色

Fog Bottom Color：下层雾效颜色

Gradient Top：上层过渡

Gradient Bottom：下层过渡

Fog start：雾效距离相机的初始距离

### 2.环境光控制（必开）
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669625593-4d7067f1-e85d-4855-8ff2-a60fa9cfd65c.png)

**每个选项的作用**

Sky Box Material：天空球（所有场景，尽量使用天空球，不要用山寨的模型天空球）

Sun Source：太阳光设置（太阳光设置就是此场景的平行光，假如没有，是室内场景，那么也需要设置一个）

Source：环境光模式（选Color或Gradient）

Ambient Color：环境光颜色（Color模式一个颜色调全局，Gradient模式颜色亮部中部暗部分别调整）

### 3.体积光（消耗大，尽量不要开）
使用需要得到主美或者直属领导的许可

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669660556-fbc9d618-6c77-41b7-836a-6ad5daa6a4d5.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669668763-d9af3a58-56f2-44d6-b4bf-9f6814413609.png)

Pixel samples：采样，数值越大，越好，推荐32以下

scattering：体积光的扩散强度

extinction：衰减程度

skybox：数值越大，越不受体积光影响

texture：降分辨率采样的比例，数值越大，内存越小，效果越差

anisotropy：真实环境一般是开，光线从一个点来发散计算

scalar：扩散强度

dither strength：颗粒状的密度，越大，颗粒越明显，推荐10左右

dither scale：贴图循环的数值，推荐1

### 4.阴影（必开）
![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669692299-ecd0599e-0370-4a10-8277-18b640705941.png)

尽量距离越小越好，开销也越小，因为计算内容变少，同时精度也会根据距离参数变化，越大精度越差

### 5.屏幕空间平面反射


## 角色脚本（Environment Volume）
**Environment Volume****脚本跟角色光放在同一个预制体内**

在角色灯光预制体中创建Create Empty，改名为Environment Volume

点击add component，添加Environment Volume

Environment Volume的layer层级要设置为PostProcess_01

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669744462-61dd9595-b676-4a88-aeb3-e6c125ef0768.png)

### 1.角色环境色（必开）
设置角色的环境色，可以根据不同色调的场景进行微调，比如夜晚蓝色，那么角色环境色可以偏蓝，这个需要考虑角色效果，所以不一定和场景匹配都可以，如果这里不设置颜色，那么会读一个通用的灰色的配置

### 2.SSAO（消耗大，使用需要评估）
动态AO，特殊场景中，可以使用这个效果，增加画面立体感，但是开销较大，战斗不要使用

养成界面这种资源比较可控的特殊场景，需要开启，因为会影响角色的AO效果

模式参考下面设置，参数可以调整

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669770223-459f539d-8714-4392-978c-3580d354d44b.png)

### 3.自定义阴影（必开）
灯光选择角色的平行光

下面是一些投影效果的参数参考下图即可

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669786384-0dc58401-c459-4086-9176-73c70b4c5de0.png)

1.指定阴影光源（平行光，聚光灯）

2.产生阴影的范围，要产生阴影的单位相对于光源z坐标上的正向距离 <= 阴影范围

3.开启角色自阴影

4.开启角色对场景阴影

5.当视野内只能看到角色对场景投影,看不到该角色时需要勾选

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669842658-43f85c6d-36cf-4659-8a39-c63f5f6d1c16.png)

1.当角色需要开启补光时，需要勾选

2.阴影出现条纹，适当调大

3.自阴影强度

4.减少阴影失真问题，加强明暗过度

补光光源指定：强度最高的平行光或者LightSettingVolume中指定URP主光源

补光阴影限制：

在场景需要使用主光源阴影时，不应勾选

场景材质接收URP阴影时会产生两套角色对场景投影

# 后期设置：
**场景中必须添加后期脚本**

在场景中创建Create Empty，改名为Sce_Public_（场景名）_post

点击add component，添加Volume

后期组件放在公用文件夹，能通用的尽量通用

后期脚本的layer层级要设置为PostProcess_01



## 必须设置的基础后期
### 渲染层次
后期需要层级关系

常规场景：**post3**

对话，3D界面中出现的后期设置：**post2**

### （辉光）Bloom
开销很大，但是效果影响很大，可以根据高中低配的机型进行设置，比如低配不开，因为渲染中，辉光最费，参数见下图

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717669104357-1592f347-e769-47b7-96b0-c07a6645d206.png)

### （色调映射）Tonemapping
免费的开销，还有其他两种模式，但是不要去使用，因为没人玩得溜，可以自己去研究，但是目前阶段项目中暂时不要使用

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717668643258-2b1ab0f2-4e6a-4eed-809b-6bd2455ccbcc.png)

### （色彩调整）Color Adjustments
免费的开销，这里的参考最好是参考下面的设置，不要太强，也不要出现负值。

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717668676848-8134fc09-e0c6-4002-845a-17274538016e.png)

## 其他后期使用说明
### （颜色曲线）Color Curves
免费开销，通过曲线去调节画面全局的对比关系和深浅灰度，因为是全局调整，所以只能适当设置很小的参数，强化画面的对比关系

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717668756841-3b2437f3-0ff0-4df7-ab2c-a0fc7ac72e7c.png)

### （提升、伽马、增益）Lift Gamma Gain
免费的开销

### （阴影、中间色调、高亮）Shadows Midtones Highlights
免费的开销

### （景深）Depth Of Field
开销昂贵，只有特殊环境才能使用，比如养成界面，NPC对话界面，结算界面，技能镜头。

使用效果之前需要和自己的直属领导或者主美确认

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717668908029-1eb15263-5e1f-4cea-b12e-a5b4d02e324e.png)

### （颜色滤镜）Color Lookup
开销昂贵，特殊情况才能使用，他可以调出很多特殊的色调

使用效果之前需要和自己的直属领导或者主美确认

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717668933134-01b60d33-9679-484f-a5bd-426067cc3b75.png)

### （暗角）Vignette
消耗不大，但一般场景不会用到

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717670210951-f02df6b2-a127-4ad0-8015-627298d95abb.png)

尽量用最少的脚本来制作效果，因为素材越多，管理成本越高，调试的难度越大，到最后自己可能都不知道是哪里调出来的问题，导致画面效果不好

战斗场景需要尽量统一后期参数，如果特殊色调，那么需要进战斗验证角色和特效效果，不能偏差太大

## 禁止使用的后期
这些后期不能使用，其余根据效果自由发挥，但是要注意个度，不要大幅度影响角色与特效

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717668835046-e8f298df-0f82-4f10-bbe0-be8735ba4c6a.png)



# 烘培
战斗；主城，角色养成界面等实体化场景都需要设置成烘焙灯光

烘焙设置：参考亚文化场景

灯光设置文件，需要和LM存放到一个路径，这个文件生成之后需要手动挪位置

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717670385184-8dc16a39-a0c4-412a-8ce0-610fea74ed48.png)

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717670392028-73158880-8248-4b54-832f-ad8a2862697a.png)

红色参数照抄即可

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717670408568-593a9bd0-9f2c-4fae-99f7-d5f5746221c2.png)

上面一行，代表烘焙的像素精度，越大，LM越多，时间越长，一般来讲，战斗这种面积的场景最好是10或者15即可

下面的参数代表LM的间距，预防UV有重叠的情况，建议4左右

模型设置：参考下图设置才能烘焙LM

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717670424963-3dde9267-209c-48cb-8ec0-d0d63612f8e4.png)

不需要产生动态投影的物体关掉投影，会大幅度节约性能

![](https://cdn.nlark.com/yuque/0/2024/png/44842280/1717670438256-a1c74f52-c9a8-4536-aea8-e4f238966d72.png)



## 注意事项：
**<font style="color:#DF2A3F;">进入引擎阶段后，所有操作在引擎内执行，禁止在pc文件夹直接操作改名、修改文件位置等操作</font>**

