# 概述
## 文档说明
本文主要阐述通用Buff机制、命中率Buff和倍率Buff效果、生效时机、生效范围、边界情况、获得方式等。



## 文档维护
| <font style="color:#FFFFFF;">版本</font> | <font style="color:#FFFFFF;">时间</font> | <font style="color:#FFFFFF;">负责人</font> | <font style="color:#FFFFFF;">修改内容</font> |
| --- | --- | --- | --- |
| v1.0 | 2024.9.30 | 何佳蔚 | 文档创建 |
| v1.1 | 2024.10.4 | 何佳蔚 | 新增“倍率Buff模块” |




## 设计思路
预期中，命中率Buff是一个面向研发和运营、玩家不可见，调控玩家实际游戏体验的工具，反映到游戏中是调控玩家当前捕鱼时命中的概率。

倍率Buff是控制玩家是否能打出高倍鱼的体验影响因素。

# Buff通用机制
## Buff获得方式
### 道具获得
Buff的形式会做成一个**隐形道具**，不会触发“物品获得”弹窗，同时在“物品获得”弹窗内也不显示，道具效果为自动使用，使用效果为获得Buff表里对应id的一个buff。

道具表内配置的Buff id，不考虑以下特殊情况的条件，直接获得并生效。

### 特殊情况获得
获取条件直接配置在Buff表中，由Buff机制去处理Buff获得的情况。

例如“每日登录时，获得Buff”

## 命中率Buff持续时间
为了让Buff生效可控，需要给每个Buff增加一个持续的时间范围，避免太多不同命中率的Buff混合在一起，达不成最开始投放Buff的目的。

# <font style="color:rgb(5, 7, 59);background-color:rgb(253, 253, 254);">命中率Buff</font>
## 命中率Buff效果
命中率Buff影响“在一定金币数范围内（正或负），玩家打鱼时的命中率加成（正或负）”

## 命中率Buff生效判定
在命中率公式中，会计算每次鱼的当前命中概率和本次命中的随机数之间进行对比。

玩家每次捕鱼时，需要额外做一次判断，判断此次捕鱼成功/失败是否落在了buff影响命中率的那部分权重内，才会去减掉Buff相应的金币数量。



## 获得多个命中率Buff时
已知一个Buff会影响玩家的命中率，且仅在一定金币数量的范围内生效。

当玩家身上有多个Buff时，Buff会把上述两个效果合并，对玩家来讲永远只有一个Buff。

策划的预期是“Buff只是让玩家多赚一部分钱/亏掉一部分钱，这部分钱就是buff的金币数，概率是控制他体验的，实际无所谓”

①当玩家命中率为正时，继续获得命中率为正的Buff，生效时取命中率更高的（反之取低的）；金币数量叠加。

_例如登录时获得一个命中率加成1%，生效金币1w的buff；之后又冲了钱，获得一个命中率加成2%，生效金币2w的buff。玩家身上的Buff变更为命中率加成2%，生效金币1w+2w=3w。_

②当玩家命中率为正时，获得一个命中率为负的Buff

若正金币＞负金币，则命中率不变，金币相减；

若正金币＜负金币，则命中率变为负，生效金币大的减小的。



# 倍率Buff
## 倍率Buff效果
倍率Buff影响“后x条带倍率的Boss鱼，倍率加成升高/降低x档”

## 倍率Buff生效判定
当玩家打死Boss鱼后，获得最高/最低倍奖励，且此时拥有倍率升高/降低x档的buff，buff不生效且不计算鱼数量，其余情况倍率Buff都正常生效并计数。

## 获得多个倍率Buff时
倍率Buff不叠加，排队依次生效。





