## 名称规范
### 工作簿名称
+ 配置表的工作簿名称为英文，存储为xlsm格式
+ 名称采用帕斯卡命名法：单词首字母大写，例如OpenFunction.xlsm
+ 配置表名称需要能够非常容易的确认到其功能作用

### Sheet名称
+ 配置表的Sheet名称需要以帕斯卡命名法（大驼峰）使用全英文
+ Sheet名称不宜过长，但力求能够比较简单的确认其功能
    - 例如ActivityBase.json
+ Sheet名称首个单词和功能相关
    - 例如Activity表中Sheet名分别为**Activity**Base.json、**Activity**Config.json等

### 字段名称
+ 按照现行项目的通用规范，Sheet名称的首两行用作字段名，名称以下划线命名法使用全英文
+ 同一个Sheet中的字段名不能重复，需要尽量也保证同一个工作簿中的字段名不要重复
+ 字段名称不宜过长，但力求能够比较简单的确认其功能
    - 例如task_name
+ 配置页的第一列必须是id，且必须合并
+ 配置页的第二列建议作为策划备注，第二列首行为空

![](https://cdn.nlark.com/yuque/0/2024/png/43256847/1718255864148-faa197e7-e4be-4a6d-9282-c2c346231e70.png)

### 数据类型
+ Normal
    - 默认数据类型，所有数据理应都有Normal类型，在有多种类型时可被省略
    - 可与其他数据类型共存（和Table互为替代）
+ Array
    - “数组”类数据，用于该列下会配置 **多个数据 **时的数据类型
    - 该数据类型下，多个数据间用**英文标点-分号**进行分隔
    - 可与其他数据类型共存
+ Lang
    - “文本”类数据，用于该列下会配置 **被翻译** 的数据时的数据类型
    - 该数据类型下，数据一般都为中文
    - 可与其他数据类型共存
+ Table
    - 当该列前的id为合并单元格时，弃用**Normal**改用**Table**，不可被省略
    - 可与其他数据类型共存（和Normal互为替代）

以上数据类型在多种类型共存时，需要用**英文标点-逗号**进行分隔。

当存在表头有总分结构时，分出来的次级列的数据类型需要用**英文标点-分号**进行分隔，且此时如有Normal，Normal不能被省略。

## 配置规范
配置表组成为一个或多个配置Sheet和一个注释Sheet

非特殊情况下不应当将任何的Sheet进行隐藏

不应当将Sheet标签设置为带颜色

### 设计规范
	▪避免冗余配置					

		不要加入任何形式的冗余配置，保证有且仅有一处配置来实现功能							

		反例如下：																	

		_VIP礼包在VIP表格中配置了一次，在活动表格中又配置了一次_						

		造成在两个不同的页面中分别读取了两处表格，并且客户端和服务器也不一致																					

	▪做好ID段规划					

		对于id预期很多的大表，一定要提前做好id段的划分（例如道具Item表）

		必要的话，可以在注释页后面额外再新增一个id划分段的注释表

		也可以类似当前的String表，使用单独的行来注明id段的划分

		对于类似digimon->digimonSkill之类的总分型的id，需要保证关联性

		另外配置表中的配置需要按照ID升序的方式进行排序

		需要进行id段划分的表格：

		item,drop,string,skill,equipment等

		文档附页中有单独的ID段划分范例								

																					

	▪使用约定范例					

		对于类似reward之类的配置，尽量采用项目中通过的做法，方便策划也方便程序					

		比如reward字段下面有array形式的type和value，不要另造轮子							

		项目中已存在的约定的范例形成一个比较通用的规范维护									

																	

	▪精简配置				

		设计表格的时候，尽量精简不必要的配置，在不能精简配置的情况的没必要拆出多个互相引用的表格	

		对有大量重复的配置，应当将其中比较固定的部分单独拆出来								

		举一个反例,Dialogue表格有如下的引用关系

DialogueBase

| <font style="color:white;">id</font> | | | | | <font style="color:white;">step_index</font> |
| :---: | --- | --- | --- | --- | --- |
| <font style="color:black;">1101</font> | | | | <font style="color:black;">迷惑森林的秘密</font> | <font style="color:black;">110101</font> |
| | | | | | <font style="color:black;">110102</font> |
| | | | | | <font style="color:black;">110103</font> |


DialogueStepInfo

| <font style="color:white;">id</font> | | | | | <font style="color:white;">step_id</font> | <font style="color:white;">其他配置</font> |
| :---: | --- | --- | --- | --- | :---: | :---: |
| <font style="color:black;">110101</font> | | | | **<font style="color:black;">迷惑森林的秘密</font>** | <font style="color:black;">1</font> | <font style="color:black;">…</font> |
| <font style="color:black;">110102</font> | | | | | <font style="color:black;">2</font> | <font style="color:black;">…</font> |
| <font style="color:black;">110103</font> | | | | | <font style="color:black;">3</font> | <font style="color:black;">…</font> |


以上两个表格可以精简为 ↓ 

| <font style="color:white;">id</font> | | | | | <font style="color:white;">其他配置</font> |
| :---: | --- | --- | --- | --- | :---: |
| <font style="color:black;">1101</font> | | | | <font style="color:black;">迷惑森林的秘密</font> | <font style="color:black;">…</font> |
| | | | | | <font style="color:black;">…</font> |
| | | | | | <font style="color:black;">…</font> |


▪使用系统专用的Define表						

		对于某个系统的上层配置或通用配置，第一个Sheet建立系统名+Define表，配置修改不频繁的内容

### 执行规范
	▪禁用公式					

		不要使用任何形式的公式，如果必须用，需要将结果粘贴成为数值

		一般做法为把公式内容放在本地设计表，或放在配置表中无票头的区域（不推荐）			

	▪禁用空单元格					

		所有的配置单元格都不能为空，没有实际作用的单元格需要配置为0

		（需和程序提前说明，处理好配置0的情况，避免加新字段时他人不清楚用法配0后导致的报错）		

	▪禁用文本类数字					

		不应当使用文本类的数字，需要转换为正常的数字格式				

	▪禁用小数					

		配置表格中不能直接配置小数，当需要使用小数时，需要和程序约定使用整数来代表千/万分比		

	▪禁用日期格式					

		对于类似Schedule表格中需要配置日期的单元格，不应当使用日期格式，应当使用文本格式		

	▪禁止临时配置					

		非特殊情况禁止有任何临时配置到正式分支上

		禁止配置任何类似等级99级，365天之后的看似无限的数值，容易埋雷

	▪“批注”功能						

		在表格的用法已有单独的注释页说明时，不需要加入额外的批注说明				

### 注释规范					
		配置表的用法说明统一开一个新的Sheet，以双下划线开始，名称为“__注释”				

		策划文档中的关于配置表格的说明，等建立了新的表格之后，可以直接剪切到注释页中			

		保证每个配置有一处可供参考的注释	

## 格式规范
尽量将配置表的格式整理的干净清晰，提升文档的可读性

### 基础格式					
	▪统一字号					

		工作簿尽量保证使用同一个字号（默认为11）				

	▪统一字体					

		工作簿尽量保证使用同一个字体（默认为宋体）				

	▪合理使用颜色					

		字段单元格颜色使用统一的色号，字体颜色使用高对比度的其他颜色				

		非字段单元格默认使用黑色字体，单元格无填充				

		有特殊的需要将一些配置行统一使用一种色号				

		但配置页尽量少使用颜色，也不要单独只把某些单元格标注特殊颜色				

	▪文字对齐					

		Sheet需要使用统一的单元格对齐方式，一般默认即可				

	▪行高列宽自适应					

		String表之外的其他表格，行高使用默认，列宽使用自适应，				

		部分特别长的单元格无法显示全部则调整为默认列宽				

		String表格，勾选自动换行，列宽调整到比较合适的宽度，行高使用自适应				

	▪合理使用边框					

		为方便将相关的配置归类为组，可以多使用粗框线

### 其他格式					
	▪工作表缩放					

		Sheet不要使用缩放，使用默认的100%，默认显示网格线				

	▪	冻结视图				

		Sheet需要冻结id列和字段行，方便其他人查阅				

	▪	尽量减少合并单元格				

		通常情况下不应合并单元格，但是因为项目中合并单元格有特殊用法，所以规则内允许使用合并单元格;

		注意不要使用合并单元格的格式刷来合并其他单元格，否则会有隐藏的未被实际合并的单元格带来BUG

## 性能及安全性
	尽量减少导致性能下降和容易出错的相关因素

### 性能相关
		▪避免添加对象		

			不要加入类似形状的任意形式的对象	

		▪减少使用数据验证		

			通常情况下不应当有数据验证，特殊情况下可以酌情慎用	

		▪减少使用条件格式		

			通常情况下不应当有条件格式，特殊情况下可以酌情慎用	

		▪禁用表格		

			不要使用表格，使用表格之后诸如合并单元格之类的功能都会无法使用	

### 安全相关		
		▪禁用其他宏

			不要加入除Base.xlam外的其他的宏	

		▪禁用外部链接		

			不应当使用任何的外部链接	

		▪减少使用筛选		

			不应当有筛选按钮等（必要时使用后再关闭，保证提交的表格没有筛选）	

		▪禁止排序		

			不应当对配置进行排序

> 配置表范例
>
> [配置表说明.xlsx](https://snh48group.yuque.com/attachments/yuque/0/2024/xlsx/43256847/1718258578029-d5d69b6f-a908-4d57-9d98-73ac0b33d75b.xlsx)
>



